#new:Header $Header
{
	[MainScript] $Script_Main
	[Background] 00000000
	[EntryList] $EntryList
	[EntryCount] 3
      [MapTattle]  $Function_GetTattle
}

#new:EntryList $EntryList
{
	~Vec4f:Entry0
	~Vec4f:Entry1
	~Vec4f:Entry2
}

#new:Function_Init $Function_Init
{
	PUSH    RA
	LIA     A0, 800B0CF0
	LIA     A1, "tst_tex"
	JAL     800654F0 % sprintf
	RESERVED
	CLEAR  V0
	JPOP   RA
}

#new:Script_Main $Script_Main
{
	Set   *GB_WorldLocation  .Location:DryDryOutpost
	Call  SetCamPerspective  ( .Cam:Default 00000003 00000019 00000010 00001000 )
	Call  SetCamBGColor      ( .Cam:Default 00000000 00000000 00000000 )
	Call  SetCamEnabled      ( .Cam:Default .True )
	Call  SetCamLeadPlayer   ( .Cam:Default .False )
	Call  MakeNpcs ( .False $NpcGroupList_tyd02 )
	Exec  $Script_SetupMusic
	Exec  $Script_SetupTexturePan
	Exec  $Script_BindFoliage
      Exec  $Script_MakeEntities
	Exec  $Script_EnterMap
	Return
	End
}

#new:Script $Script_EnterMap
{
    Call    GetEntryID ( *Var0 )
    If *Var0 == ~Entry:Entry2
        Set   *VarA $Script_CreateExitTriggers
        Set   *VarB ~Collider:Exit2
        Exec  $Script_EnterHorizontalPipe
    Else
        Set  *VarA $Script_CreateExitTriggers
        Exec $Script_EnterVerticalPipe
    EndIf
	Return
	End
}

#new:Script $Script_MakeEntities
{
    Call  MakeEntity        ( .Entity:SuperBlock ~Vec4d:Entity_SuperBlock 80000000 )
    Set   *MapVar[0]  *Var0
    Call  AssignBlockFlag   ( *GF_TYD02_Shine )
    Call  AssignScript      ( $Script_Entity_Shine1 )
    Return
    End
}

#new:Script $Script_Entity_Shine1
{
    Set *Var0 *MapVar[0] % entityID
    SetConst *Var1 *GF_TYD02_Shine % flag
    ExecWait $Script_ShineBlock
    Return
    End
}

#new:Script $Script_CreateExitTriggers
{
    Bind  $Script_Exit0 .Trigger:FloorTouch ~Collider:Exit0 00000001 00000000
    Bind  $Script_Exit1 .Trigger:FloorTouch ~Collider:Exit1 00000001 00000000
    Bind  $Script_Exit2 .Trigger:WallPush ~Collider:Exit2 00000001 00000000
	Return
	End
}

#new:Script $Script_Exit0
{
    SetGroup 0000001B
    Set   *VarA ~Entry:Entry0
    Set   *VarB ~Collider:Exit0
    Set   *VarC $Script_GoToMap_Exit0
    ExecWait  $Script_ExitVerticalPipe
    Return
    End
}

#new:Script $Script_Exit1
{
    SetGroup 0000001B
	Set   *VarA ~Entry:Entry1
	Set   *VarB ~Collider:Exit1
	Set   *VarC $Script_GoToMap_Exit1
	ExecWait  $Script_ExitVerticalPipe
	Return
	End
}

#new:Script $Script_Exit2
{
    SetGroup 0000001B
	Set   *VarA ~Entry:Entry2
	Set   *VarB ~Collider:Exit2
	Set   *VarC $Script_GoToMap_Exit2
	ExecWait  $Script_ExitHorizontalPipe
	Return
	End
}

#new:Script $Script_GoToMap_Exit0
{
    Call  GotoMap   ( "dro_04" 00000001 )
    Wait  100`
    Return
    End
}

#new:Script $Script_GoToMap_Exit1
{
    Call  GotoMap   ( "tyd_02" 00000002 )
    Wait  100`
    Return
    End
}

#new:Script $Script_GoToMap_Exit2
{
    Call  GotoMap   ( "tyd_02" 00000001 )
    Wait  100`
    Return
    End
}

#new:Script $Script_SetupMusic
{
	Call  SetMusicTrack ( 00000000 000000A8 00000000 00000008 )
	Call  PlayAmbientSounds ( .AmbientSounds:Wind )
	Return
	End
}

% NPCs

#new:NpcGroupList $NpcGroupList_tyd02
{
00000001 $NpcGroup_DarkPuff 	3B040003
00000002 $NpcGroup_PalePiranha1	3B050003
00000002 $NpcGroup_PalePiranha2	3B050003
00000000 00000000 00000000 
}

%==============
% Dark Puff's code

#new:Npc $NpcGroup_DarkPuff {
00000000 $NpcSettings_802440C8_flo_16 ~Vec3f:NPC_Enemy0
00000C00 00000000 00000000 00000000 0000005A 
~Items:10:SuperShroom:A ~HP:Standard:2 ~FP:Standard:2 ~CoinBonus:0:2
~Movement:NPC_Enemy0
~AnimationTable:NPC_Enemy0 % .Sprite:TuffPuff
00000003 00000000 00000000 00000000 % no tattle string
}

#new:Function $Function_80240E50_flo_16 {
    0:  ADDIU     SP, SP, FFC8
    4:  SW        S3, 2C (SP)
    8:  COPY      S3, A0
    C:  SW        RA, 30 (SP)
   10:  SW        S2, 28 (SP)
   14:  SW        S1, 24 (SP)
   18:  SW        S0, 20 (SP)
   1C:  LW        S1, 148 (S3)
   20:  LH        A0, 8 (S1)
   24:  JAL       ~Func:get_npc_unsafe
   28:  COPY      S2, A1
   2C:  LW        A0, 4 (S2)
   30:  COPY      S0, V0
   34:  SRL       V1, A0, 1F
   38:  ADDU      A0, A0, V1
   3C:  SRA       A0, A0, 1
   40:  JAL       ~Func:rand_int
   44:  ADDIU     A0, A0, 1
   48:  LW        V1, 4 (S2)
   4C:  SRL       A0, V1, 1F
   50:  ADDU      V1, V1, A0
   54:  SRA       V1, V1, 1
   58:  ADDU      V1, V1, V0
   5C:  SH        V1, 8E (S0)
   60:  LW        V1, D0 (S1)
   64:  LWC1      F0, 40 (S0)
   68:  LWC1      F4, 0 (V1)
   6C:  CVT.S.W   F4, F4
   70:  LWC1      F2, 8 (V1)
   74:  CVT.S.W   F2, F2
   78:  SWC1      F0, 10 (SP)
   7C:  LW        V0, D0 (S1)
   80:  MFC1      A2, F2
   84:  LWC1      F0, C (V0)
   88:  CVT.S.W   F0, F0
   8C:  SWC1      F0, 14 (SP)
   90:  LW        V0, D0 (S1)
   94:  MFC1      A1, F4
   98:  LWC1      F0, 10 (V0)
   9C:  CVT.S.W   F0, F0
   A0:  SWC1      F0, 18 (SP)
   A4:  LW        A0, 18 (V1)
   A8:  JAL       ~Func:is_point_within_region
   AC:  LW        A3, 38 (S0)
   B0:  BEQ       V0, R0, .oEC
   B4:  NOP
   B8:  LW        V0, D0 (S1)
   BC:  LWC1      F12, 38 (S0)
   C0:  LWC1      F14, 40 (S0)
   C4:  LWC1      F6, 0 (V0)
   C8:  CVT.S.W   F6, F6
   CC:  MFC1      A2, F6
   D0:  LWC1      F6, 8 (V0)
   D4:  CVT.S.W   F6, F6
   D8:  MFC1      A3, F6
   DC:  JAL       ~Func:atan2
   E0:  NOP
   E4:  BEQ       R0, R0, .o11C
   E8:  SWC1      F0, C (S0)
        .oEC
   EC:  JAL       ~Func:rand_int
   F0:  LI        A0, 3C
   F4:  LWC1      F12, C (S0)
   F8:  MTC1      V0, F0
   FC:  NOP
  100:  CVT.S.W   F0, F0
  104:  ADD.S     F12, F12, F0
  108:  LIF       F0, 30.0
  110:  JAL       ~Func:clamp_angle
  114:  SUB.S     F12, F12, F0
  118:  SWC1      F0, C (S0)
        .o11C
  11C:  LW        V0, CC (S1)
  120:  LW        V0, 4 (V0)
  124:  SW        V0, 28 (S0)
  128:  SW        R0, 74 (S3)
  12C:  LW        V0, D0 (S1)
  130:  LW        V0, 14 (V0)
  134:  BGEZ      V0, .o148
  138:  NOP
  13C:  LWC1      F0, 0 (S2)
  140:  BEQ       R0, R0, .o168
  144:  SWC1      F0, 18 (S0)
        .o148
  148:  LAD       F2, $ConstDouble_802453F0_flo_16
  150:  MTC1      V0, F0
  154:  NOP
  158:  CVT.D.W   F0, F0
  15C:  DIV.D     F0, F0, F2
  160:  CVT.S.D   F0, F0
  164:  SWC1      F0, 18 (S0)
        .o168
  168:  LWC1      F0, 3C (S0)
  16C:  LIF       F3, 3.390625
  174:  MTC1      R0, F2
  178:  CVT.D.S   F0, F0
  17C:  MUL.D     F0, F0, F2
  180:  NOP
  184:  LI        V0, 1
  188:  TRUNC.W.D F6, F0
  18C:  SWC1      F6, 7C (S1)
  190:  SW        V0, 70 (S3)
  194:  LW        RA, 30 (SP)
  198:  LW        S3, 2C (SP)
  19C:  LW        S2, 28 (SP)
  1A0:  LW        S1, 24 (SP)
  1A4:  LW        S0, 20 (SP)
  1A8:  JR        RA
  1AC:  ADDIU     SP, SP, 38
}

#new:Function $Function_80241000_flo_16 {
    0:  ADDIU     SP, SP, FF80
    4:  SW        S3, 4C (SP)
    8:  COPY      S3, A0
    C:  SW        RA, 58 (SP)
   10:  SW        S5, 54 (SP)
   14:  SW        S4, 50 (SP)
   18:  SW        S2, 48 (SP)
   1C:  SW        S1, 44 (SP)
   20:  SW        S0, 40 (SP)
   24:  SDC1      F26, 78 (SP)
   28:  SDC1      F24, 70 (SP)
   2C:  SDC1      F22, 68 (SP)
   30:  SDC1      F20, 60 (SP)
   34:  LW        S1, 148 (S3)
   38:  COPY      S2, A1
   3C:  LH        A0, 8 (S1)
   40:  JAL       ~Func:get_npc_unsafe
   44:  COPY      S5, A2
   48:  COPY      S0, V0
   4C:  CLEAR     S4
   50:  LWC1      F4, 7C (S1)
   54:  CVT.S.W   F4, F4
   58:  LWC1      F2, 88 (S1)
   5C:  CVT.S.W   F2, F2
   60:  CVT.D.S   F2, F2
   64:  CVT.D.S   F4, F4
   68:  LWC1      F0, 3C (S0)
   6C:  LIF       F7, 3.390625
   74:  MTC1      R0, F6
   78:  CVT.D.S   F0, F0
   7C:  MUL.D     F0, F0, F6
   80:  NOP
   84:  LI        V0, 1
   88:  LW        A0, 6C (S1)
   8C:  DIV.D     F2, F2, F6
   90:  CVT.S.D   F2, F2
   94:  DIV.D     F4, F4, F6
   98:  CVT.S.D   F20, F4
   9C:  ANDI      V1, A0, 11
   A0:  TRUNC.W.D F8, F0
   A4:  SWC1      F8, 7C (S1)
   A8:  LWC1      F0, 78 (S1)
   AC:  CVT.S.W   F0, F0
   B0:  CVT.D.S   F0, F0
   B4:  DIV.D     F0, F0, F6
   B8:  CVT.S.D   F26, F0
   BC:  LWC1      F0, 70 (S1)
   C0:  CVT.S.W   F0, F0
   C4:  CVT.D.S   F0, F0
   C8:  DIV.D     F0, F0, F6
   CC:  CVT.S.D   F22, F0
   D0:  BNE       V1, V0, .o168
   D4:  ADD.S     F24, F26, F2
   D8:  LW        V0, 0 (S0)
   DC:  ANDI      V0, V0, 8
   E0:  BEQ       V0, R0, .o108
   E4:  ADDIU     A1, SP, 28
   E8:  LWC1      F0, 3C (S0)
   EC:  SUB.S     F0, F24, F0
   F0:  C.LT.S    F22, F0
   F4:  NOP
   F8:  BC1F      .o168
   FC:  ORI       V0, A0, 10
  100:  BEQ       R0, R0, .o168
  104:  SW        V0, 6C (S1)
        .o108
  108:  ADDIU     A2, SP, 2C
  10C:  LWC1      F0, 38 (S0)
  110:  LWC1      F2, 3C (S0)
  114:  LWC1      F4, 40 (S0)
  118:  LIF       F6, 1000.0
  120:  ADDIU     V0, SP, 34
  124:  SWC1      F0, 28 (SP)
  128:  SWC1      F2, 2C (SP)
  12C:  SWC1      F4, 30 (SP)
  130:  SWC1      F6, 34 (SP)
  134:  SW        V0, 10 (SP)
  138:  LW        A0, 80 (S0)
  13C:  JAL       ~Func:npc_raycast_down_sides
  140:  ADDIU     A3, SP, 30
  144:  LWC1      F0, 34 (SP)
  148:  SUB.S     F0, F26, F0
  14C:  C.LT.S    F22, F0
  150:  NOP
  154:  BC1F      .o168
  158:  NOP
  15C:  LW        V0, 6C (S1)
  160:  ORI       V0, V0, 10
  164:  SW        V0, 6C (S1)
        .o168
  168:  LW        V0, 6C (S1)
  16C:  LI        V1, 11
  170:  ANDI      V0, V0, 11
  174:  BNE       V0, V1, .o25C
  178:  NOP
  17C:  LW        V0, 0 (S0)
  180:  ANDI      V0, V0, 8
  184:  BEQ       V0, R0, .o1B0
  188:  MOV.S     F4, F24
  18C:  SUB.S     F2, F24, F20
  190:  LAD       F0, $ConstDouble_802453F8_flo_16
  198:  CVT.D.S   F2, F2
  19C:  MUL.D     F2, F2, F0
  1A0:  NOP
  1A4:  CVT.D.S   F0, F20
  1A8:  BEQ       R0, R0, .o214
  1AC:  ADD.D     F0, F0, F2
        .o1B0
  1B0:  ADDIU     A1, SP, 28
  1B4:  ADDIU     A2, SP, 2C
  1B8:  LWC1      F0, 38 (S0)
  1BC:  LWC1      F2, 40 (S0)
  1C0:  LIF       F4, 1000.0
  1C8:  ADDIU     V0, SP, 34
  1CC:  SWC1      F20, 2C (SP)
  1D0:  SWC1      F0, 28 (SP)
  1D4:  SWC1      F2, 30 (SP)
  1D8:  SWC1      F4, 34 (SP)
  1DC:  SW        V0, 10 (SP)
  1E0:  LW        A0, 80 (S0)
  1E4:  JAL       ~Func:npc_raycast_down_sides
  1E8:  ADDIU     A3, SP, 30
  1EC:  LWC1      F4, 2C (SP)
  1F0:  ADD.S     F4, F4, F26
  1F4:  SUB.S     F2, F4, F20
  1F8:  LAD       F0, $ConstDouble_80245400_flo_16
  200:  CVT.D.S   F2, F2
  204:  MUL.D     F2, F2, F0
  208:  NOP
  20C:  CVT.D.S   F0, F20
  210:  ADD.D     F0, F0, F2
        .o214
  214:  CVT.S.D   F0, F0
  218:  SWC1      F0, 3C (S0)
  21C:  LWC1      F0, 3C (S0)
  220:  SUB.S     F0, F4, F0
  224:  LIF       F3, 1.875
  22C:  MTC1      R0, F2
  230:  ABS.S     F0, F0
  234:  CVT.D.S   F0, F0
  238:  C.LT.D    F0, F2
  23C:  NOP
  240:  BC1F      .o31C
  244:  LI        V1, FFEF
  248:  SWC1      F4, 3C (S0)
  24C:  LW        V0, 6C (S1)
  250:  AND       V0, V0, V1
  254:  BEQ       R0, R0, .o31C
  258:  SW        V0, 6C (S1)
        .o25C
  25C:  LW        V0, 70 (S1)
  260:  BLEZ      V0, .o31C
  264:  NOP
  268:  LWC1      F12, 74 (S1)
  26C:  JAL       ~Func:sin_deg
  270:  CVT.S.W   F12, F12
  274:  LW        V0, 0 (S0)
  278:  ANDI      V0, V0, 8
  27C:  BEQ       V0, R0, .o28C
  280:  MOV.S     F20, F0
  284:  BEQ       R0, R0, .o2CC
  288:  CLEAR     V0
        .o28C
  28C:  ADDIU     A1, SP, 28
  290:  ADDIU     A2, SP, 2C
  294:  LWC1      F0, 38 (S0)
  298:  LWC1      F2, 3C (S0)
  29C:  LWC1      F4, 40 (S0)
  2A0:  LIF       F6, 1000.0
  2A8:  ADDIU     V0, SP, 34
  2AC:  SWC1      F0, 28 (SP)
  2B0:  SWC1      F2, 2C (SP)
  2B4:  SWC1      F4, 30 (SP)
  2B8:  SWC1      F6, 34 (SP)
  2BC:  SW        V0, 10 (SP)
  2C0:  LW        A0, 80 (S0)
  2C4:  JAL       ~Func:npc_raycast_down_sides
  2C8:  ADDIU     A3, SP, 30
        .o2CC
  2CC:  BEQ       V0, R0, .o2EC
  2D0:  NOP
  2D4:  MUL.S     F2, F20, F22
  2D8:  NOP
  2DC:  LWC1      F0, 2C (SP)
  2E0:  ADD.S     F0, F0, F26
  2E4:  BEQ       R0, R0, .o2F8
  2E8:  ADD.S     F0, F0, F2
        .o2EC
  2EC:  MUL.S     F0, F20, F22
  2F0:  NOP
  2F4:  ADD.S     F0, F24, F0
        .o2F8
  2F8:  SWC1      F0, 3C (S0)
  2FC:  LW        V0, 74 (S1)
  300:  ADDIU     V0, V0, A
  304:  MTC1      V0, F12
  308:  NOP
  30C:  JAL       ~Func:clamp_angle
  310:  CVT.S.W   F12, F12
  314:  TRUNC.W.S F8, F0
  318:  SWC1      F8, 74 (S1)
        .o31C
  31C:  LW        V0, 90 (S1)
  320:  BGTZ      V0, .o44C
  324:  ADDIU     V0, V0, FFFF
  328:  LW        V1, 14 (S2)
  32C:  BLTZ      V1, .o450
  330:  NOP
  334:  LW        V0, 74 (S3)
  338:  BGTZ      V0, .o444
  33C:  ADDIU     V0, V0, FFFF
  340:  SW        V1, 74 (S3)
  344:  LH        V0, A8 (S0)
  348:  LWC1      F2, 3C (S0)
  34C:  MTC1      V0, F0
  350:  NOP
  354:  CVT.S.W   F0, F0
  358:  ADD.S     F2, F2, F0
  35C:  LIF       F1, 2.5625
  364:  MTC1      R0, F0
  368:  LAW       V0, 800F7B30
  370:  CVT.D.S   F2, F2
  374:  ADD.D     F2, F2, F0
  378:  LWC1      F0, 2C (V0)
  37C:  CVT.D.S   F0, F0
  380:  C.LT.D    F0, F2
  384:  NOP
  388:  BC1F      .o43C
  38C:  COPY      A0, S5
  390:  SW        R0, 10 (SP)
  394:  LW        A2, C (S2)
  398:  LW        A3, 10 (S2)
  39C:  JAL       800490B4
  3A0:  COPY      A1, S1
  3A4:  BEQ       V0, R0, .o43C
  3A8:  CLEAR     A0
  3AC:  COPY      A1, S0
  3B0:  CLEAR     A2
  3B4:  LI        S2, C
  3B8:  LH        V1, A8 (S0)
  3BC:  LIF       F0, 1.0
  3C4:  LIF       F2, 2.0
  3CC:  LIF       F4, -20.0
  3D4:  MTC1      V1, F8
  3D8:  NOP
  3DC:  CVT.S.W   F8, F8
  3E0:  MFC1      A3, F8
  3E4:  ADDIU     V0, SP, 38
  3E8:  SW        S2, 1C (SP)
  3EC:  SW        V0, 20 (SP)
  3F0:  SWC1      F0, 10 (SP)
  3F4:  SWC1      F2, 14 (SP)
  3F8:  JAL       ~Func:fx_emote
  3FC:  SWC1      F4, 18 (SP)
  400:  COPY      A0, S0
  404:  LI        A1, 2F4
  408:  LWC1      F0, 3C (A0)
  40C:  LUI       A2, 20
  410:  JAL       ~Func:ai_enemy_play_sound
  414:  SWC1      F0, 64 (A0)
  418:  LW        V0, 18 (S1)
  41C:  LHU       V0, 2A (V0)
  420:  ANDI      V0, V0, 1
  424:  BEQ       V0, R0, .o434
  428:  LI        V0, A
  42C:  BEQ       R0, R0, .o5F4
  430:  SW        V0, 70 (S3)
        .o434
  434:  BEQ       R0, R0, .o5F4
  438:  SW        S2, 70 (S3)
        .o43C
  43C:  LW        V0, 74 (S3)
  440:  ADDIU     V0, V0, FFFF
        .o444
  444:  BEQ       R0, R0, .o450
  448:  SW        V0, 74 (S3)
        .o44C
  44C:  SW        V0, 90 (S1)
        .o450
  450:  LW        V1, D0 (S1)
  454:  LWC1      F0, 40 (S0)
  458:  LWC1      F2, 0 (V1)
  45C:  CVT.S.W   F2, F2
  460:  LWC1      F4, 8 (V1)
  464:  CVT.S.W   F4, F4
  468:  SWC1      F0, 10 (SP)
  46C:  LW        V0, D0 (S1)
  470:  MFC1      A1, F2
  474:  LWC1      F0, C (V0)
  478:  CVT.S.W   F0, F0
  47C:  SWC1      F0, 14 (SP)
  480:  LW        V0, D0 (S1)
  484:  MFC1      A2, F4
  488:  LWC1      F0, 10 (V0)
  48C:  CVT.S.W   F0, F0
  490:  SWC1      F0, 18 (SP)
  494:  LW        A0, 18 (V1)
  498:  JAL       ~Func:is_point_within_region
  49C:  LW        A3, 38 (S0)
  4A0:  BEQ       V0, R0, .o50C
  4A4:  NOP
  4A8:  LW        A2, 38 (S0)
  4AC:  LW        V0, D0 (S1)
  4B0:  LW        A3, 40 (S0)
  4B4:  LWC1      F12, 0 (V0)
  4B8:  CVT.S.W   F12, F12
  4BC:  LWC1      F14, 8 (V0)
  4C0:  JAL       ~Func:dist2D
  4C4:  CVT.S.W   F14, F14
  4C8:  LWC1      F2, 18 (S0)
  4CC:  C.LT.S    F2, F0
  4D0:  NOP
  4D4:  BC1F      .o50C
  4D8:  SWC1      F0, 34 (SP)
  4DC:  LWC1      F12, 38 (S0)
  4E0:  LW        V0, D0 (S1)
  4E4:  LWC1      F14, 40 (S0)
  4E8:  LWC1      F8, 0 (V0)
  4EC:  CVT.S.W   F8, F8
  4F0:  MFC1      A2, F8
  4F4:  LWC1      F8, 8 (V0)
  4F8:  CVT.S.W   F8, F8
  4FC:  MFC1      A3, F8
  500:  JAL       ~Func:atan2
  504:  LI        S4, 1
  508:  SWC1      F0, C (S0)
        .o50C
  50C:  LW        V0, D0 (S1)
  510:  LW        V1, C (V0)
  514:  LW        V0, 10 (V0)
  518:  OR        V1, V1, V0
  51C:  OR        V1, V1, S4
  520:  BEQ       V1, R0, .o544
  524:  NOP
  528:  LH        V0, 8C (S0)
  52C:  BNE       V0, R0, .o5F4
  530:  NOP
  534:  LW        A1, 18 (S0)
  538:  LW        A2, C (S0)
  53C:  JAL       ~Func:npc_move_heading
  540:  COPY      A0, S0
        .o544
  544:  LWC1      F0, 3C (S0)
  548:  LIF       F3, 3.390625
  550:  MTC1      R0, F2
  554:  CVT.D.S   F0, F0
  558:  MUL.D     F0, F0, F2
  55C:  NOP
  560:  TRUNC.W.D F8, F0
  564:  SWC1      F8, 7C (S1)
  568:  LW        V0, 4 (S2)
  56C:  BLEZ      V0, .o5F4
  570:  NOP
  574:  LH        V0, 8E (S0)
  578:  LHU       V1, 8E (S0)
  57C:  BLEZ      V0, .o594
  580:  ADDIU     V0, V1, FFFF
  584:  SH        V0, 8E (S0)
  588:  SLL       V0, V0, 10
  58C:  BGTZ      V0, .o5F4
  590:  NOP
        .o594
  594:  LI        A0, 3E8
  598:  LI        V0, 2
  59C:  JAL       ~Func:rand_int
  5A0:  SW        V0, 70 (S3)
  5A4:  LI        V1, 55555556
  5AC:  MULT      V0, V1
  5B0:  SRA       A0, V0, 1F
  5B4:  MFHI      T0
  5B8:  SUBU      A0, T0, A0
  5BC:  SLL       V1, A0, 1
  5C0:  ADDU      V1, V1, A0
  5C4:  SUBU      V0, V0, V1
  5C8:  ADDIU     V1, V0, 2
  5CC:  SW        V1, 74 (S3)
  5D0:  LW        V0, 2C (S2)
  5D4:  BLEZL     V0, .o5F4
  5D8:  SW        R0, 70 (S3)
  5DC:  LW        V0, 8 (S2)
  5E0:  BLEZ      V0, .o5F0
  5E4:  SLTI      V0, V1, 3
  5E8:  BEQ       V0, R0, .o5F4
  5EC:  NOP
        .o5F0
  5F0:  SW        R0, 70 (S3)
        .o5F4
  5F4:  LW        RA, 58 (SP)
  5F8:  LW        S5, 54 (SP)
  5FC:  LW        S4, 50 (SP)
  600:  LW        S3, 4C (SP)
  604:  LW        S2, 48 (SP)
  608:  LW        S1, 44 (SP)
  60C:  LW        S0, 40 (SP)
  610:  LDC1      F26, 78 (SP)
  614:  LDC1      F24, 70 (SP)
  618:  LDC1      F22, 68 (SP)
  61C:  LDC1      F20, 60 (SP)
  620:  JR        RA
  624:  ADDIU     SP, SP, 80
}

#new:Function $Function_80241628_flo_16 {
    0:  ADDIU     SP, SP, FFD8
    4:  SW        S3, 1C (SP)
    8:  COPY      S3, A0
    C:  SW        RA, 20 (SP)
   10:  SW        S2, 18 (SP)
   14:  SW        S1, 14 (SP)
   18:  SW        S0, 10 (SP)
   1C:  LW        S2, 148 (S3)
   20:  LH        A0, 8 (S2)
   24:  JAL       ~Func:get_npc_unsafe
   28:  COPY      S1, A1
   2C:  LW        A0, 8 (S1)
   30:  COPY      S0, V0
   34:  SRL       V1, A0, 1F
   38:  ADDU      A0, A0, V1
   3C:  SRA       A0, A0, 1
   40:  JAL       ~Func:rand_int
   44:  ADDIU     A0, A0, 1
   48:  LW        V1, 8 (S1)
   4C:  LI        A0, B4
   50:  SRL       A1, V1, 1F
   54:  ADDU      V1, V1, A1
   58:  SRA       V1, V1, 1
   5C:  ADDU      V1, V1, V0
   60:  JAL       ~Func:rand_int
   64:  SH        V1, 8E (S0)
   68:  LWC1      F12, C (S0)
   6C:  MTC1      V0, F0
   70:  NOP
   74:  CVT.S.W   F0, F0
   78:  ADD.S     F12, F12, F0
   7C:  LIF       F0, 90.0
   84:  JAL       ~Func:clamp_angle
   88:  SUB.S     F12, F12, F0
   8C:  SWC1      F0, C (S0)
   90:  LW        V0, CC (S2)
   94:  LW        V0, 0 (V0)
   98:  SW        V0, 28 (S0)
   9C:  LI        V0, 3
   A0:  SW        V0, 70 (S3)
   A4:  LW        RA, 20 (SP)
   A8:  LW        S3, 1C (SP)
   AC:  LW        S2, 18 (SP)
   B0:  LW        S1, 14 (SP)
   B4:  LW        S0, 10 (SP)
   B8:  JR        RA
   BC:  ADDIU     SP, SP, 28
}

#new:Function $Function_802416E8_flo_16 {
    0:  ADDIU     SP, SP, FF88
    4:  SW        S3, 4C (SP)
    8:  COPY      S3, A0
    C:  SW        RA, 54 (SP)
   10:  SW        S4, 50 (SP)
   14:  SW        S2, 48 (SP)
   18:  SW        S1, 44 (SP)
   1C:  SW        S0, 40 (SP)
   20:  SDC1      F26, 70 (SP)
   24:  SDC1      F24, 68 (SP)
   28:  SDC1      F22, 60 (SP)
   2C:  SDC1      F20, 58 (SP)
   30:  LW        S1, 148 (S3)
   34:  COPY      S2, A1
   38:  LH        A0, 8 (S1)
   3C:  JAL       ~Func:get_npc_unsafe
   40:  COPY      S4, A2
   44:  COPY      S0, V0
   48:  LWC1      F0, 78 (S1)
   4C:  CVT.S.W   F0, F0
   50:  CVT.D.S   F0, F0
   54:  LIF       F3, 3.390625
   5C:  MTC1      R0, F2
   60:  LH        V0, 8E (S0)
   64:  LHU       V1, 8E (S0)
   68:  DIV.D     F0, F0, F2
   6C:  CVT.S.D   F24, F0
   70:  LWC1      F0, 88 (S1)
   74:  CVT.S.W   F0, F0
   78:  CVT.D.S   F0, F0
   7C:  DIV.D     F0, F0, F2
   80:  CVT.S.D   F0, F0
   84:  BLEZ      V0, .o94
   88:  ADD.S     F26, F24, F0
   8C:  ADDIU     V0, V1, FFFF
   90:  SH        V0, 8E (S0)
        .o94
   94:  LW        V0, 70 (S1)
   98:  BLEZ      V0, .o16C
   9C:  NOP
   A0:  LWC1      F12, 74 (S1)
   A4:  CVT.S.W   F12, F12
   A8:  MTC1      V0, F0
   AC:  NOP
   B0:  CVT.S.W   F0, F0
   B4:  CVT.D.S   F0, F0
   B8:  DIV.D     F0, F0, F2
   BC:  JAL       ~Func:sin_deg
   C0:  CVT.S.D   F22, F0
   C4:  LW        V0, 0 (S0)
   C8:  ANDI      V0, V0, 8
   CC:  BEQ       V0, R0, .oDC
   D0:  MOV.S     F20, F0
   D4:  BEQ       R0, R0, .o11C
   D8:  CLEAR     V0
        .oDC
   DC:  ADDIU     A1, SP, 28
   E0:  ADDIU     A2, SP, 2C
   E4:  LWC1      F0, 38 (S0)
   E8:  LWC1      F2, 3C (S0)
   EC:  LWC1      F4, 40 (S0)
   F0:  LIF       F6, 1000.0
   F8:  ADDIU     V0, SP, 34
   FC:  SWC1      F0, 28 (SP)
  100:  SWC1      F2, 2C (SP)
  104:  SWC1      F4, 30 (SP)
  108:  SWC1      F6, 34 (SP)
  10C:  SW        V0, 10 (SP)
  110:  LW        A0, 80 (S0)
  114:  JAL       ~Func:npc_raycast_down_sides
  118:  ADDIU     A3, SP, 30
        .o11C
  11C:  BEQ       V0, R0, .o13C
  120:  NOP
  124:  MUL.S     F2, F20, F22
  128:  NOP
  12C:  LWC1      F0, 2C (SP)
  130:  ADD.S     F0, F0, F24
  134:  BEQ       R0, R0, .o148
  138:  ADD.S     F0, F0, F2
        .o13C
  13C:  MUL.S     F0, F20, F22
  140:  NOP
  144:  ADD.S     F0, F26, F0
        .o148
  148:  SWC1      F0, 3C (S0)
  14C:  LW        V0, 74 (S1)
  150:  ADDIU     V0, V0, A
  154:  MTC1      V0, F12
  158:  NOP
  15C:  JAL       ~Func:clamp_angle
  160:  CVT.S.W   F12, F12
  164:  TRUNC.W.S F8, F0
  168:  SWC1      F8, 74 (S1)
        .o16C
  16C:  LW        V0, 90 (S1)
  170:  BGTZ      V0, .o274
  174:  ADDIU     V0, V0, FFFF
  178:  LH        V0, A8 (S0)
  17C:  LWC1      F0, 3C (S0)
  180:  MTC1      V0, F2
  184:  NOP
  188:  CVT.S.W   F2, F2
  18C:  LAW       V0, 800F7B30
  194:  ADD.S     F0, F0, F2
  198:  LIF       F5, 2.5625
  1A0:  MTC1      R0, F4
  1A4:  LWC1      F2, 2C (V0)
  1A8:  CVT.D.S   F0, F0
  1AC:  ADD.D     F0, F0, F4
  1B0:  CVT.D.S   F2, F2
  1B4:  C.LT.D    F2, F0
  1B8:  NOP
  1BC:  BC1F      .o278
  1C0:  COPY      A0, S4
  1C4:  LI        V0, 1
  1C8:  SW        V0, 10 (SP)
  1CC:  LW        A2, 24 (S2)
  1D0:  LW        A3, 28 (S2)
  1D4:  JAL       800490B4
  1D8:  COPY      A1, S1
  1DC:  BEQ       V0, R0, .o278
  1E0:  CLEAR     A0
  1E4:  COPY      A1, S0
  1E8:  CLEAR     A2
  1EC:  LI        S2, C
  1F0:  LH        V1, A8 (S0)
  1F4:  LIF       F0, 1.0
  1FC:  LIF       F2, 2.0
  204:  LIF       F4, -20.0
  20C:  MTC1      V1, F8
  210:  NOP
  214:  CVT.S.W   F8, F8
  218:  MFC1      A3, F8
  21C:  ADDIU     V0, SP, 38
  220:  SW        S2, 1C (SP)
  224:  SW        V0, 20 (SP)
  228:  SWC1      F0, 10 (SP)
  22C:  SWC1      F2, 14 (SP)
  230:  JAL       ~Func:fx_emote
  234:  SWC1      F4, 18 (SP)
  238:  COPY      A0, S0
  23C:  LI        A1, 2F4
  240:  LWC1      F0, 3C (A0)
  244:  LUI       A2, 20
  248:  JAL       ~Func:ai_enemy_play_sound
  24C:  SWC1      F0, 64 (A0)
  250:  LW        V0, 18 (S1)
  254:  LHU       V0, 2A (V0)
  258:  ANDI      V0, V0, 1
  25C:  BEQ       V0, R0, .o26C
  260:  LI        V0, A
  264:  BEQ       R0, R0, .o314
  268:  SW        V0, 70 (S3)
        .o26C
  26C:  BEQ       R0, R0, .o314
  270:  SW        S2, 70 (S3)
        .o274
  274:  SW        V0, 90 (S1)
        .o278
  278:  LH        V0, 8C (S0)
  27C:  BNE       V0, R0, .o314
  280:  NOP
  284:  LH        V0, 8E (S0)
  288:  BGTZ      V0, .o314
  28C:  NOP
  290:  LW        V0, 74 (S3)
  294:  ADDIU     V0, V0, FFFF
  298:  BLEZ      V0, .o310
  29C:  SW        V0, 74 (S3)
  2A0:  LW        V0, 18 (S1)
  2A4:  LHU       V0, 2A (V0)
  2A8:  ANDI      V0, V0, 10
  2AC:  BNE       V0, R0, .o2CC
  2B0:  NOP
  2B4:  LWC1      F0, C (S0)
  2B8:  LIF       F12, 180.0
  2C0:  JAL       ~Func:clamp_angle
  2C4:  ADD.S     F12, F0, F12
  2C8:  SWC1      F0, C (S0)
        .o2CC
  2CC:  JAL       ~Func:rand_int
  2D0:  LI        A0, 3E8
  2D4:  LI        V1, 2E8BA2E9
  2DC:  MULT      V0, V1
  2E0:  SRA       V1, V0, 1F
  2E4:  MFHI      T0
  2E8:  SRA       A0, T0, 1
  2EC:  SUBU      A0, A0, V1
  2F0:  SLL       V1, A0, 1
  2F4:  ADDU      V1, V1, A0
  2F8:  SLL       V1, V1, 2
  2FC:  SUBU      V1, V1, A0
  300:  SUBU      V0, V0, V1
  304:  ADDIU     V0, V0, 5
  308:  BEQ       R0, R0, .o314
  30C:  SH        V0, 8E (S0)
        .o310
  310:  SW        R0, 70 (S3)
        .o314
  314:  LW        RA, 54 (SP)
  318:  LW        S4, 50 (SP)
  31C:  LW        S3, 4C (SP)
  320:  LW        S2, 48 (SP)
  324:  LW        S1, 44 (SP)
  328:  LW        S0, 40 (SP)
  32C:  LDC1      F26, 70 (SP)
  330:  LDC1      F24, 68 (SP)
  334:  LDC1      F22, 60 (SP)
  338:  LDC1      F20, 58 (SP)
  33C:  JR        RA
  340:  ADDIU     SP, SP, 78
}

#new:Function $Function_80241A2C_flo_16 {
    0:  ADDIU     SP, SP, FFE0
    4:  SW        S2, 18 (SP)
    8:  COPY      S2, A0
    C:  SW        RA, 1C (SP)
   10:  SW        S1, 14 (SP)
   14:  SW        S0, 10 (SP)
   18:  LW        S1, 148 (S2)
   1C:  JAL       ~Func:get_npc_unsafe
   20:  LH        A0, 8 (S1)
   24:  COPY      S0, V0
   28:  LAW       V0, 800F7B30
   30:  LWC1      F12, 38 (S0)
   34:  LWC1      F14, 40 (S0)
   38:  SH        R0, 8E (S0)
   3C:  LW        A2, 28 (V0)
   40:  JAL       ~Func:atan2
   44:  LW        A3, 30 (V0)
   48:  SWC1      F0, C (S0)
   4C:  LW        V0, CC (S1)
   50:  LW        V0, 20 (V0)
   54:  SW        V0, 28 (S0)
   58:  LI        V0, B
   5C:  SW        V0, 70 (S2)
   60:  LW        RA, 1C (SP)
   64:  LW        S2, 18 (SP)
   68:  LW        S1, 14 (SP)
   6C:  LW        S0, 10 (SP)
   70:  JR        RA
   74:  ADDIU     SP, SP, 20
}

#new:Function $Function_80241AA4_flo_16 {
    0:  ADDIU     SP, SP, FFE8
    4:  SW        S0, 10 (SP)
    8:  COPY      S0, A0
    C:  SW        RA, 14 (SP)
   10:  LW        V0, 148 (S0)
   14:  JAL       ~Func:get_npc_unsafe
   18:  LH        A0, 8 (V0)
   1C:  LHU       V1, 8E (V0)
   20:  LWC1      F0, 3C (V0)
   24:  ADDIU     A0, V1, 1
   28:  SLL       V1, V1, 10
   2C:  SRA       V1, V1, E
   30:  SH        A0, 8E (V0)
   34:  LTF       F2, V1 ($FloatTable_80244010_flo_16)
   40:  LH        V1, 8E (V0)
   44:  ADD.S     F0, F0, F2
   48:  SLTI      V1, V1, 5
   4C:  BNE       V1, R0, .o5C
   50:  SWC1      F0, 3C (V0)
   54:  LI        V0, C
   58:  SW        V0, 70 (S0)
        .o5C
   5C:  LW        RA, 14 (SP)
   60:  LW        S0, 10 (SP)
   64:  JR        RA
   68:  ADDIU     SP, SP, 18
}

#new:Function $Function_80242038_flo_16 {
    0:  ADDIU     SP, SP, FFC8
    4:  SW        S0, 28 (SP)
    8:  COPY      S0, A1
    C:  SW        S1, 2C (SP)
   10:  COPY      S1, A2
   14:  SW        RA, 34 (SP)
   18:  SW        S2, 30 (SP)
   1C:  SW        R0, 70 (S1)
   20:  LW        V1, 0 (A0)
   24:  LI        V0, FDFF
   28:  SH        R0, 8E (A0)
   2C:  AND       V1, V1, V0
   30:  ORI       A1, V1, 800
   34:  SW        A1, 0 (A0)
   38:  LW        V0, D0 (S0)
   3C:  LW        V0, 34 (V0)
   40:  BEQ       V0, R0, .o50
   44:  COPY      S2, A3
   48:  BEQ       R0, R0, .o58
   4C:  ORI       V0, V1, 808
        .o50
   50:  LI        V0, FFF7
   54:  AND       V0, A1, V0
        .o58
   58:  SW        V0, 0 (A0)
   5C:  ADDIU     V0, SP, 24
   60:  ADDIU     A1, SP, 18
   64:  LWC1      F0, 38 (A0)
   68:  LWC1      F2, 3C (A0)
   6C:  LWC1      F4, 40 (A0)
   70:  LIF       F6, 1000.0
   78:  ADDIU     A2, SP, 1C
   7C:  SWC1      F0, 18 (SP)
   80:  SWC1      F2, 1C (SP)
   84:  SWC1      F4, 20 (SP)
   88:  SWC1      F6, 24 (SP)
   8C:  SW        V0, 10 (SP)
   90:  LW        A0, 80 (A0)
   94:  JAL       ~Func:npc_raycast_down_sides
   98:  ADDIU     A3, SP, 20
   9C:  LWC1      F2, 24 (SP)
   A0:  LIF       F5, 3.390625
   A8:  MTC1      R0, F4
   AC:  CVT.D.S   F2, F2
   B0:  MUL.D     F2, F2, F4
   B4:  NOP
   B8:  LWC1      F0, 1C (SP)
   BC:  CVT.D.S   F0, F0
   C0:  MUL.D     F0, F0, F4
   C4:  NOP
   C8:  LIF       F5, 1.75
   D0:  MTC1      R0, F4
   D4:  NOP
   D8:  ADD.D     F2, F2, F4
   DC:  SW        R0, 74 (S0)
   E0:  ADD.D     F0, F0, F4
   E4:  SW        R0, 90 (S0)
   E8:  TRUNC.W.D F8, F2
   EC:  SWC1      F8, 78 (S0)
   F0:  TRUNC.W.D F8, F0
   F4:  SWC1      F8, 88 (S0)
   F8:  LW        V0, 14 (S2)
   FC:  SW        V0, 74 (S1)
  100:  LW        V0, B0 (S0)
  104:  ORI       V0, V0, 10
  108:  SW        V0, B0 (S0)
  10C:  LW        RA, 34 (SP)
  110:  LW        S2, 30 (SP)
  114:  LW        S1, 2C (SP)
  118:  LW        S0, 28 (SP)
  11C:  JR        RA
  120:  ADDIU     SP, SP, 38
}

#new:Function $Function_80242348_flo_16 {
    0:  ADDIU     SP, SP, FFD0
    4:  SW        S3, 1C (SP)
    8:  COPY      S3, A0
    C:  SW        RA, 20 (SP)
   10:  SW        S2, 18 (SP)
   14:  SW        S1, 14 (SP)
   18:  SW        S0, 10 (SP)
   1C:  SDC1      F20, 28 (SP)
   20:  LW        S1, 148 (S3)
   24:  LH        A0, 8 (S1)
   28:  JAL       ~Func:get_npc_unsafe
   2C:  COPY      S0, A1
   30:  LW        A0, 20 (S0)
   34:  COPY      S2, V0
   38:  SRL       V1, A0, 1F
   3C:  ADDU      A0, A0, V1
   40:  SRA       A0, A0, 1
   44:  JAL       ~Func:rand_int
   48:  ADDIU     A0, A0, 1
   4C:  LW        V1, 20 (S0)
   50:  LWC1      F12, 38 (S2)
   54:  SRL       A0, V1, 1F
   58:  ADDU      V1, V1, A0
   5C:  SRA       V1, V1, 1
   60:  ADDU      V1, V1, V0
   64:  SH        V1, 8E (S2)
   68:  LW        V0, CC (S1)
   6C:  LWC1      F14, 40 (S2)
   70:  LW        V0, C (V0)
   74:  SW        V0, 28 (S2)
   78:  LWC1      F0, 18 (S0)
   7C:  LAW       V0, 800F7B30
   84:  SWC1      F0, 18 (S2)
   88:  LW        A2, 28 (V0)
   8C:  JAL       ~Func:atan2
   90:  LW        A3, 30 (V0)
   94:  MOV.S     F20, F0
   98:  LWC1      F12, C (S2)
   9C:  JAL       ~Func:get_clamped_angle_diff
   A0:  MOV.S     F14, F20
   A4:  MOV.S     F2, F0
   A8:  LW        V0, 1C (S0)
   AC:  ABS.S     F0, F2
   B0:  MTC1      V0, F4
   B4:  NOP
   B8:  CVT.S.W   F4, F4
   BC:  C.LT.S    F4, F0
   C0:  NOP
   C4:  BC1F      .oFC
   C8:  NOP
   CC:  MTC1      R0, F0
   D0:  LWC1      F20, C (S2)
   D4:  C.LT.S    F2, F0
   D8:  NOP
   DC:  BC1F      .oF8
   E0:  SUBU      V0, R0, V0
   E4:  MTC1      V0, F0
   E8:  NOP
   EC:  CVT.S.W   F0, F0
   F0:  BEQ       R0, R0, .oFC
   F4:  ADD.S     F20, F20, F0
        .oF8
   F8:  ADD.S     F20, F20, F4
        .oFC
   FC:  JAL       ~Func:clamp_angle
  100:  MOV.S     F12, F20
  104:  LI        V0, D
  108:  SWC1      F0, C (S2)
  10C:  SW        V0, 70 (S3)
  110:  LW        RA, 20 (SP)
  114:  LW        S3, 1C (SP)
  118:  LW        S2, 18 (SP)
  11C:  LW        S1, 14 (SP)
  120:  LW        S0, 10 (SP)
  124:  LDC1      F20, 28 (SP)
  128:  JR        RA
  12C:  ADDIU     SP, SP, 30
}

#new:Function $Function_80242478_flo_16 {
    0:  ADDIU     SP, SP, FFA8
    4:  SW        S3, 4C (SP)
    8:  COPY      S3, A0
    C:  SW        RA, 50 (SP)
   10:  SW        S2, 48 (SP)
   14:  SW        S1, 44 (SP)
   18:  SW        S0, 40 (SP)
   1C:  LW        S2, 148 (S3)
   20:  COPY      S1, A1
   24:  LH        A0, 8 (S2)
   28:  JAL       ~Func:get_npc_unsafe
   2C:  COPY      S0, A2
   30:  COPY      A0, S0
   34:  COPY      A1, S2
   38:  LI        V1, 1
   3C:  SW        V1, 10 (SP)
   40:  LW        A2, 24 (S1)
   44:  LW        A3, 28 (S1)
   48:  JAL       800490B4
   4C:  COPY      S0, V0
   50:  BNE       V0, R0, .oD4
   54:  LI        A0, 2
   58:  COPY      A1, S0
   5C:  CLEAR     A2
   60:  LH        V1, A8 (S0)
   64:  LIF       F0, 1.0
   6C:  LIF       F2, 2.0
   74:  LIF       F4, -20.0
   7C:  LI        V0, F
   80:  SW        V0, 1C (SP)
   84:  MTC1      V1, F8
   88:  NOP
   8C:  CVT.S.W   F8, F8
   90:  MFC1      A3, F8
   94:  ADDIU     V0, SP, 28
   98:  SW        V0, 20 (SP)
   9C:  SWC1      F0, 10 (SP)
   A0:  SWC1      F2, 14 (SP)
   A4:  JAL       ~Func:fx_emote
   A8:  SWC1      F4, 18 (SP)
   AC:  LW        V0, CC (S2)
   B0:  LW        V1, 0 (V0)
   B4:  LI        V0, 1E
   B8:  SH        V0, 8E (S0)
   BC:  LI        V0, 14
   C0:  SW        V1, 28 (S0)
   C4:  SW        V0, 70 (S3)
   C8:  LI        V0, 1E
   CC:  BEQ       R0, R0, .o264
   D0:  SW        V0, 90 (S2)
        .oD4
   D4:  LW        A1, 18 (S0)
   D8:  LW        A2, C (S0)
   DC:  JAL       ~Func:npc_move_heading
   E0:  COPY      A0, S0
   E4:  LW        V0, 0 (S0)
   E8:  ANDI      V0, V0, 8
   EC:  BNE       V0, R0, .o190
   F0:  CLEAR     S1
   F4:  ADDIU     A1, SP, 2C
   F8:  ADDIU     A2, SP, 30
   FC:  LH        V0, A8 (S0)
  100:  LWC1      F0, 38 (S0)
  104:  MTC1      V0, F2
  108:  NOP
  10C:  CVT.S.W   F2, F2
  110:  SWC1      F0, 2C (SP)
  114:  LH        V0, A8 (S0)
  118:  LWC1      F4, 3C (S0)
  11C:  LWC1      F6, 40 (S0)
  120:  MTC1      V0, F0
  124:  NOP
  128:  CVT.D.W   F0, F0
  12C:  ADD.S     F4, F4, F2
  130:  LIF       F3, 2.125
  138:  MTC1      R0, F2
  13C:  ADDIU     V0, SP, 38
  140:  ADD.D     F0, F0, F2
  144:  SWC1      F6, 34 (SP)
  148:  SWC1      F4, 30 (SP)
  14C:  CVT.S.D   F0, F0
  150:  SWC1      F0, 38 (SP)
  154:  SW        V0, 10 (SP)
  158:  LW        A0, 80 (S0)
  15C:  JAL       ~Func:npc_raycast_down_sides
  160:  ADDIU     A3, SP, 34
  164:  BEQ       V0, R0, .o190
  168:  NOP
  16C:  LH        V0, A8 (S0)
  170:  LWC1      F2, 38 (SP)
  174:  MTC1      V0, F0
  178:  NOP
  17C:  CVT.S.W   F0, F0
  180:  C.LT.S    F2, F0
  184:  NOP
  188:  BC1TL     .o190
  18C:  LI        S1, 1
        .o190
  190:  BEQ       S1, R0, .o1B4
  194:  NOP
  198:  LWC1      F0, 30 (SP)
  19C:  LIF       F3, 1.875
  1A4:  MTC1      R0, F2
  1A8:  CVT.D.S   F0, F0
  1AC:  BEQ       R0, R0, .o23C
  1B0:  ADD.D     F0, F0, F2
        .o1B4
  1B4:  LAW       V0, 800F7B30
  1BC:  LIF       F3, 2.375
  1C4:  MTC1      R0, F2
  1C8:  LWC1      F0, 2C (V0)
  1CC:  LWC1      F4, 3C (S0)
  1D0:  CVT.D.S   F0, F0
  1D4:  ADD.D     F0, F0, F2
  1D8:  CVT.D.S   F4, F4
  1DC:  SUB.D     F0, F4, F0
  1E0:  CVT.S.D   F6, F0
  1E4:  MTC1      R0, F0
  1E8:  MTC1      R0, F1
  1EC:  CVT.D.S   F2, F6
  1F0:  C.LT.D    F2, F0
  1F4:  NOP
  1F8:  BC1T      .o220
  1FC:  NOP
  200:  LIF       F1, 2.25
  208:  MTC1      R0, F0
  20C:  NOP
  210:  C.LT.D    F0, F2
  214:  NOP
  218:  BC1F      .o244
  21C:  NOP
        .o220
  220:  LAD       F2, $ConstDouble_80245448_flo_16
  228:  NEG.S     F6, F6
  22C:  CVT.D.S   F0, F6
  230:  MUL.D     F0, F0, F2
  234:  NOP
  238:  ADD.D     F0, F4, F0
        .o23C
  23C:  CVT.S.D   F0, F0
  240:  SWC1      F0, 3C (S0)
        .o244
  244:  LH        V0, 8E (S0)
  248:  LHU       V1, 8E (S0)
  24C:  BLEZ      V0, .o25C
  250:  ADDIU     V0, V1, FFFF
  254:  BEQ       R0, R0, .o264
  258:  SH        V0, 8E (S0)
        .o25C
  25C:  LI        V0, C
  260:  SW        V0, 70 (S3)
        .o264
  264:  LW        RA, 50 (SP)
  268:  LW        S3, 4C (SP)
  26C:  LW        S2, 48 (SP)
  270:  LW        S1, 44 (SP)
  274:  LW        S0, 40 (SP)
  278:  JR        RA
  27C:  ADDIU     SP, SP, 58
}

#new:Function $Function_802426F8_flo_16 {
    0:  ADDIU     SP, SP, FFE0
    4:  SW        S1, 14 (SP)
    8:  COPY      S1, A0
    C:  SW        RA, 18 (SP)
   10:  SW        S0, 10 (SP)
   14:  LW        S0, 148 (S1)
   18:  JAL       ~Func:get_npc_unsafe
   1C:  LH        A0, 8 (S0)
   20:  COPY      V1, V0
   24:  LHU       V0, 8E (V1)
   28:  ADDIU     V0, V0, FFFF
   2C:  SH        V0, 8E (V1)
   30:  SLL       V0, V0, 10
   34:  BGTZ      V0, .o48
   38:  NOP
   3C:  SW        R0, 74 (S0)
   40:  SH        R0, 8E (V1)
   44:  SW        R0, 70 (S1)
        .o48
   48:  LW        RA, 18 (SP)
   4C:  LW        S1, 14 (SP)
   50:  LW        S0, 10 (SP)
   54:  JR        RA
   58:  ADDIU     SP, SP, 20
}

#new:Function $Function_80242754_flo_16 {
    0:  ADDIU     SP, SP, FFB0
    4:  SW        S4, 40 (SP)
    8:  COPY      S4, A0
    C:  SW        RA, 48 (SP)
   10:  SW        S5, 44 (SP)
   14:  SW        S3, 3C (SP)
   18:  SW        S2, 38 (SP)
   1C:  SW        S1, 34 (SP)
   20:  SW        S0, 30 (SP)
   24:  LW        S2, 148 (S4)
   28:  LH        A0, 8 (S2)
   2C:  LW        S0, C (S4)
   30:  JAL       ~Func:get_npc_unsafe
   34:  COPY      S1, A1
   38:  COPY      A0, S4
   3C:  LW        A1, 0 (S0)
   40:  JAL       ~Func:get_variable
   44:  COPY      S5, V0
   48:  SW        R0, 10 (SP)
   4C:  LW        V1, D0 (S2)
   50:  LW        V1, 30 (V1)
   54:  SW        V1, 14 (SP)
   58:  LW        V1, D0 (S2)
   5C:  LW        V1, 1C (V1)
   60:  SW        V1, 18 (SP)
   64:  LW        V1, D0 (S2)
   68:  LW        V1, 24 (V1)
   6C:  SW        V1, 1C (SP)
   70:  LW        V1, D0 (S2)
   74:  LW        V1, 28 (V1)
   78:  ADDIU     S3, SP, 10
   7C:  SW        V1, 20 (SP)
   80:  LW        V1, D0 (S2)
   84:  LIF       F0, 120.0
   8C:  LW        V1, 2C (V1)
   90:  COPY      S0, V0
   94:  SWC1      F0, 28 (SP)
   98:  SH        R0, 2C (SP)
   9C:  BEQ       S1, R0, .oBC
   A0:  SW        V1, 24 (SP)
   A4:  COPY      A0, S5
   A8:  COPY      A1, S2
   AC:  COPY      A2, S4
   B0:  JAL       $Function_80242038_flo_16
   B4:  COPY      A3, S0
   B8:  SW        R0, 70 (S4)
        .oBC
   BC:  LI        V0, FFFE
   C0:  SB        V0, AB (S5)
   C4:  LW        V1, B0 (S2)
   C8:  ANDI      V0, V1, 4
   CC:  BEQ       V0, R0, .oEC
   D0:  NOP
   D4:  LB        V0, B4 (S2)
   D8:  BNE       V0, R0, .o1C4
   DC:  CLEAR     V0
   E0:  LI        V0, FFFB
   E4:  AND       V0, V1, V0
   E8:  SW        V0, B0 (S2)
        .oEC
   EC:  LW        V1, 70 (S4)
   F0:  SLTIU     V0, V1, 15
   F4:  BEQ       V0, R0, .o1C0
   F8:  SLL       V0, V1, 2
   FC:  LTW       V0, V0 ($JumpTable_80245450_flo_16)
  108:  JR        V0
  10C:  NOP
% LBL: from $JumpTable_80245450_flo_16 , entry 0`
  110:  COPY      A0, S4
  114:  COPY      A1, S0
  118:  JAL       $Function_80240E50_flo_16
  11C:  COPY      A2, S3
% LBL: from $JumpTable_80245450_flo_16 , entry 1`
  120:  COPY      A0, S4
  124:  COPY      A1, S0
  128:  JAL       $Function_80241000_flo_16
  12C:  COPY      A2, S3
  130:  BEQ       R0, R0, .o1C4
  134:  CLEAR     V0
% LBL: from $JumpTable_80245450_flo_16 , entry 2`
  138:  COPY      A0, S4
  13C:  COPY      A1, S0
  140:  JAL       $Function_80241628_flo_16
  144:  COPY      A2, S3
% LBL: from $JumpTable_80245450_flo_16 , entry 3`
  148:  COPY      A0, S4
  14C:  COPY      A1, S0
  150:  JAL       $Function_802416E8_flo_16
  154:  COPY      A2, S3
  158:  BEQ       R0, R0, .o1C4
  15C:  CLEAR     V0
% LBL: from $JumpTable_80245450_flo_16 , entry 10`
  160:  COPY      A0, S4
  164:  COPY      A1, S0
  168:  JAL       $Function_80241A2C_flo_16
  16C:  COPY      A2, S3
% LBL: from $JumpTable_80245450_flo_16 , entry 11`
  170:  COPY      A0, S4
  174:  COPY      A1, S0
  178:  JAL       $Function_80241AA4_flo_16
  17C:  COPY      A2, S3
  180:  BEQ       R0, R0, .o1C4
  184:  CLEAR     V0
% LBL: from $JumpTable_80245450_flo_16 , entry 12`
  188:  COPY      A0, S4
  18C:  COPY      A1, S0
  190:  JAL       $Function_80242348_flo_16
  194:  COPY      A2, S3
% LBL: from $JumpTable_80245450_flo_16 , entry 13`
  198:  COPY      A0, S4
  19C:  COPY      A1, S0
  1A0:  JAL       $Function_80242478_flo_16
  1A4:  COPY      A2, S3
  1A8:  BEQ       R0, R0, .o1C4
  1AC:  CLEAR     V0
% LBL: from $JumpTable_80245450_flo_16 , entry 20`
  1B0:  COPY      A0, S4
  1B4:  COPY      A1, S0
  1B8:  JAL       $Function_802426F8_flo_16
  1BC:  COPY      A2, S3
% LBL: from $JumpTable_80245450_flo_16 , entry 19`
        .o1C0
  1C0:  CLEAR     V0
        .o1C4
  1C4:  LW        RA, 48 (SP)
  1C8:  LW        S5, 44 (SP)
  1CC:  LW        S4, 40 (SP)
  1D0:  LW        S3, 3C (SP)
  1D4:  LW        S2, 38 (SP)
  1D8:  LW        S1, 34 (SP)
  1DC:  LW        S0, 30 (SP)
  1E0:  JR        RA
  1E4:  ADDIU     SP, SP, 50
}

#new:FloatTable $FloatTable_80244010_flo_16 {
4.5      3.5      2.6      2.0      1.5      20.0
}

#new:AISettings $AISettings_80244028_flo_16 {
    1.0 % move speed
    45` % move time
    60` % wait time
  100.0 % alert radius
    0.0
    3`
    3.6 % chase speed
    10`
    1`
  120.0 % chase radius
    0.0
    1`
}

#new:Script $Script_NpcAI_80244058_flo_16 {
    0:  Call  SetSelfVar    ( 00000000 00000001 )
   14:  Call  SetSelfVar    ( 00000005 00000000 )
   28:  Call  SetSelfVar    ( 00000006 00000000 )
   3C:  Call  SetSelfVar    ( 00000001 00000258 )
   50:  Call  $Function_80242754_flo_16 ( $AISettings_80244028_flo_16 )
   60:  Return
   68:  End
}

#new:NpcSettings $NpcSettings_802440C8_flo_16 {
00000000 0018001C 00000000 00000000 $Script_NpcAI_80244058_flo_16 80077F70 00000000 8007809C 
00000000 00000000 00130000 
}

#new:ConstDouble $ConstDouble_802453F0_flo_16 {
32767.000000d
}

#new:ConstDouble $ConstDouble_802453F8_flo_16 {
0.090000d
}

#new:ConstDouble $ConstDouble_80245400_flo_16 {
0.090000d
}

#new:ConstDouble $ConstDouble_80245448_flo_16 {
0.060000d
}

#new:JumpTable $JumpTable_80245450_flo_16 {
$Function_80242754_flo_16[110] $Function_80242754_flo_16[120] $Function_80242754_flo_16[138] $Function_80242754_flo_16[148] 
$Function_80242754_flo_16[1C0] $Function_80242754_flo_16[1C0] $Function_80242754_flo_16[1C0] $Function_80242754_flo_16[1C0] 
$Function_80242754_flo_16[1C0] $Function_80242754_flo_16[1C0] $Function_80242754_flo_16[160] $Function_80242754_flo_16[170] 
$Function_80242754_flo_16[188] $Function_80242754_flo_16[198] $Function_80242754_flo_16[1C0] $Function_80242754_flo_16[1C0] 
$Function_80242754_flo_16[1C0] $Function_80242754_flo_16[1C0] $Function_80242754_flo_16[1C0] $Function_80242754_flo_16[1C0] 
$Function_80242754_flo_16[1B0] 
}

%==============

%==============
% Pale Piranha's code

#new:Npc $NpcGroup_PalePiranha1 {
00000001 $NpcSettings_80244070_mim_01 ~Vec3f:NPC_Plant1
00000400 00000000 00000000 00000000 00000000 
~Items:5:FireFlower:A ~HP:Standard:2 ~FP:Standard:3 ~CoinBonus:0:2
~Movement:NPC_Plant1
~AnimationTable:NPC_Plant1 % .Sprite:PiranhaPlant
00000001 00000000 00000000 00000000 % no tattle string
% NPC_Plant1[1F0]
00000002 $NpcSettings_802441A8_mim_01 0.0 -1000.0 0.0
00800D00 00000000 00000000 00000000 00000000 
~NoDrops
~Movement:NPC_Plant1
~AnimationTable:NPC_Plant1 % .Sprite:PiranhaPlant
00000000 00000000 00000000 00000000 % no tattle string
}

#new:Npc $NpcGroup_PalePiranha2 {
00000003 $NpcSettings_80244070_mim_01 ~Vec3f:NPC_Plant2
00000400 00000000 00000000 00000000 00000000 
~Items:5:FireFlower:A ~HP:Standard:2 ~FP:Standard:3 ~CoinBonus:0:2
~Movement:NPC_Plant2
~AnimationTable:NPC_Plant2 % .Sprite:PiranhaPlant
00000001 00000000 00000000 00000000 % no tattle string
% NPC_Plant2[1F0]
00000004 $NpcSettings_802441A8_mim_01 0.0 -1000.0 0.0
00800D00 00000000 00000000 00000000 00000000 
~NoDrops
~Movement:NPC_Plant2
~AnimationTable:NPC_Plant2 % .Sprite:PiranhaPlant
00000000 00000000 00000000 00000000 % no tattle string
}

#new:Function $Function_802414C8_kzn_03 {
    0:  ADDIU     SP, SP, FFE0
    4:  SW        S1, 14 (SP)
    8:  COPY      S1, A0
    C:  SW        RA, 18 (SP)
   10:  SW        S0, 10 (SP)
   14:  LW        S0, 148 (S1)
   18:  JAL       ~Func:get_npc_unsafe
   1C:  LH        A0, 8 (S0)
   20:  COPY      A0, V0
   24:  LH        V0, 8E (A0)
   28:  LHU       V1, 8E (A0)
   2C:  BLEZ      V0, .o3C
   30:  ADDIU     V0, V1, FFFF
   34:  BEQ       R0, R0, .o58
   38:  SH        V0, 8E (A0)
        .o3C
   3C:  LW        V0, CC (S0)
   40:  SW        R0, 6C (S0)
   44:  LW        V0, 0 (V0)
   48:  SW        V0, 28 (A0)
   4C:  LI        V0, 1
   50:  SW        R0, 74 (S1)
   54:  SW        V0, 70 (S1)
        .o58
   58:  LW        RA, 18 (SP)
   5C:  LW        S1, 14 (SP)
   60:  LW        S0, 10 (SP)
   64:  JR        RA
   68:  ADDIU     SP, SP, 20
}

#new:Function $Function_80241534_kzn_03 {
    0:  ADDIU     SP, SP, FFB8
    4:  SW        S3, 3C (SP)
    8:  COPY      S3, A0
    C:  SW        RA, 40 (SP)
   10:  SW        S2, 38 (SP)
   14:  SW        S1, 34 (SP)
   18:  SW        S0, 30 (SP)
   1C:  LW        S2, 148 (S3)
   20:  COPY      S1, A1
   24:  LH        A0, 8 (S2)
   28:  JAL       ~Func:get_npc_unsafe
   2C:  COPY      S0, A2
   30:  COPY      A0, S0
   34:  COPY      A1, S2
   38:  SW        R0, 10 (SP)
   3C:  LW        A2, C (S1)
   40:  LW        A3, 10 (S1)
   44:  JAL       800490B4
   48:  COPY      S1, V0
   4C:  BEQ       V0, R0, .oE0
   50:  COPY      A0, S1
   54:  LI        A1, 322
   58:  JAL       ~Func:ai_enemy_play_sound
   5C:  CLEAR     A2
   60:  CLEAR     A0
   64:  COPY      A1, S1
   68:  CLEAR     A2
   6C:  LI        S0, A
   70:  LH        V1, A8 (S1)
   74:  LIF       F0, 1.0
   7C:  LIF       F2, 2.0
   84:  LIF       F4, -20.0
   8C:  MTC1      V1, F6
   90:  NOP
   94:  CVT.S.W   F6, F6
   98:  MFC1      A3, F6
   9C:  ADDIU     V0, SP, 28
   A0:  SW        S0, 1C (SP)
   A4:  SW        V0, 20 (SP)
   A8:  SWC1      F0, 10 (SP)
   AC:  SWC1      F2, 14 (SP)
   B0:  JAL       ~Func:fx_emote
   B4:  SWC1      F4, 18 (SP)
   B8:  COPY      A0, S1
   BC:  LI        A1, 2F4
   C0:  JAL       ~Func:ai_enemy_play_sound
   C4:  LUI       A2, 20
   C8:  LW        V0, CC (S2)
   CC:  LW        V0, 20 (V0)
   D0:  SW        V0, 28 (S1)
   D4:  LHU       V0, 8E (S2)
   D8:  SH        V0, 8E (S1)
   DC:  SW        S0, 70 (S3)
        .oE0
   E0:  LW        RA, 40 (SP)
   E4:  LW        S3, 3C (SP)
   E8:  LW        S2, 38 (SP)
   EC:  LW        S1, 34 (SP)
   F0:  LW        S0, 30 (SP)
   F4:  JR        RA
   F8:  ADDIU     SP, SP, 48
}

#new:Function $Function_80241630_kzn_03 {
    0:  ADDIU     SP, SP, FF80
    4:  SW        RA, 64 (SP)
    8:  SW        S8, 60 (SP)
    C:  SW        S7, 5C (SP)
   10:  SW        S6, 58 (SP)
   14:  SW        S5, 54 (SP)
   18:  SW        S4, 50 (SP)
   1C:  SW        S3, 4C (SP)
   20:  SW        S2, 48 (SP)
   24:  SW        S1, 44 (SP)
   28:  SW        S0, 40 (SP)
   2C:  SDC1      F24, 78 (SP)
   30:  SDC1      F22, 70 (SP)
   34:  SDC1      F20, 68 (SP)
   38:  SW        A0, 80 (SP)
   3C:  LW        S6, 148 (A0)
   40:  COPY      S2, A2
   44:  LH        A0, 8 (S6)
   48:  JAL       ~Func:get_npc_unsafe
   4C:  CLEAR     S7
   50:  COPY      S1, V0
   54:  LHU       V0, 8E (S1)
   58:  ADDIU     V0, V0, FFFF
   5C:  SH        V0, 8E (S1)
   60:  SLL       V0, V0, 10
   64:  LW        V1, 90 (S6)
   68:  SRA       V0, V0, 10
   6C:  SLT       V1, V1, V0
   70:  BNE       V1, R0, .o88
   74:  COPY      S8, S7
   78:  LW        V0, 0 (S6)
   7C:  LUI       V1, 1F10
   80:  OR        V0, V0, V1
   84:  SW        V0, 0 (S6)
        .o88
   88:  LH        V0, 8E (S1)
   8C:  BNE       V0, R0, .oA04
   90:  NOP
   94:  LAW       V0, 800F7B30
   9C:  JAL       ~Func:clamp_angle
   A0:  LWC1      F12, A8 (V0)
   A4:  LIF       F2, 180.0
   AC:  NOP
   B0:  C.LT.S    F0, F2
   B4:  NOP
   B8:  BC1F      .o100
   BC:  NOP
   C0:  LAW       V1, 80077410
   C8:  LIF       F12, 90.0
   D0:  SLL       V0, V1, 2
   D4:  ADDU      V0, V0, V1
   D8:  SLL       V0, V0, 2
   DC:  SUBU      V0, V0, V1
   E0:  SLL       V1, V0, 3
   E4:  ADDU      V0, V0, V1
   E8:  SLL       V0, V0, 3
   EC:  LTF       F0, V0 (800B1DEC)
   F8:  BEQ       R0, R0, .o13C
   FC:  SUB.S     F12, F0, F12
        .o100
  100:  LAW       V1, 80077410
  108:  LIF       F12, 90.0
  110:  SLL       V0, V1, 2
  114:  ADDU      V0, V0, V1
  118:  SLL       V0, V0, 2
  11C:  SUBU      V0, V0, V1
  120:  SLL       V1, V0, 3
  124:  ADDU      V0, V0, V1
  128:  SLL       V0, V0, 3
  12C:  LTF       F0, V0 (800B1DEC)
  138:  ADD.S     F12, F0, F12
        .o13C
  13C:  JAL       ~Func:clamp_angle
  140:  NOP
  144:  MOV.S     F22, F0
  148:  LIF       F12, 180.0
  150:  JAL       ~Func:clamp_angle
  154:  ADD.S     F12, F22, F12
  158:  LW        V0, 88 (S6)
  15C:  BNE       V0, R0, .o1A0
  160:  MOV.S     F24, F0
  164:  LAW       V0, 800F7B30
  16C:  LB        V1, B4 (V0)
  170:  LIF       F20, 32.0
  178:  BEQ       V1, R0, .o1D4
  17C:  LI        V0, 1
  180:  LIF       F20, 100.0
  188:  BNE       V1, V0, .o1D8
  18C:  ADDIU     S0, S1, 38
  190:  LIF       F20, 90.0
  198:  BEQ       R0, R0, .o1DC
  19C:  COPY      A0, S0
        .o1A0
  1A0:  LAW       V0, 800F7B30
  1A8:  LB        V1, B4 (V0)
  1AC:  LIF       F20, 38.0
  1B4:  BEQ       V1, R0, .o1D4
  1B8:  LI        V0, 1
  1BC:  LIF       F20, 90.0
  1C4:  BNE       V1, V0, .o1D8
  1C8:  ADDIU     S0, S1, 38
  1CC:  LIF       F20, 75.0
        .o1D4
  1D4:  ADDIU     S0, S1, 38
        .o1D8
  1D8:  COPY      A0, S0
        .o1DC
  1DC:  LA        S5, 800F7B30
  1E4:  MFC1      A3, F24
  1E8:  LH        V0, A6 (S1)
  1EC:  LW        V1, 0 (S5)
  1F0:  MTC1      V0, F8
  1F4:  NOP
  1F8:  CVT.S.W   F8, F8
  1FC:  LWC1      F0, 28 (V1)
  200:  MFC1      A2, F8
  204:  ADDIU     S3, S1, 40
  208:  SWC1      F0, 38 (S1)
  20C:  LWC1      F0, 30 (V1)
  210:  COPY      A1, S3
  214:  JAL       ~Func:add_vec2D_polar
  218:  SWC1      F0, 40 (S1)
  21C:  LH        V0, A6 (S1)
  220:  MTC1      V0, F0
  224:  NOP
  228:  CVT.S.W   F0, F0
  22C:  ADD.S     F0, F20, F0
  230:  MFC1      A2, F22
  234:  MFC1      A1, F0
  238:  JAL       ~Func:npc_move_heading
  23C:  COPY      A0, S1
  240:  LW        V0, 88 (S6)
  244:  BNE       V0, R0, .o3BC
  248:  NOP
  24C:  LWC1      F0, 38 (S1)
  250:  LAD       F4, $ConstDouble_802473D8_kzn_03
  258:  CVT.D.S   F0, F0
  25C:  C.LT.D    F4, F0
  260:  NOP
  264:  BC1F      .o27C
  268:  NOP
  26C:  LIF       F0, 380.0
  274:  NOP
  278:  SWC1      F0, 38 (S1)
        .o27C
  27C:  LWC1      F0, 38 (S1)
  280:  LAD       F2, $ConstDouble_802473E0_kzn_03
  288:  CVT.D.S   F0, F0
  28C:  C.LT.D    F0, F2
  290:  NOP
  294:  BC1F      .o2AC
  298:  NOP
  29C:  LIF       F0, -380.0
  2A4:  NOP
  2A8:  SWC1      F0, 38 (S1)
        .o2AC
  2AC:  LWC1      F0, 40 (S1)
  2B0:  CVT.D.S   F0, F0
  2B4:  C.LT.D    F4, F0
  2B8:  NOP
  2BC:  BC1F      .o2D4
  2C0:  NOP
  2C4:  LIF       F0, 380.0
  2CC:  NOP
  2D0:  SWC1      F0, 40 (S1)
        .o2D4
  2D4:  LWC1      F0, 40 (S1)
  2D8:  CVT.D.S   F0, F0
  2DC:  C.LT.D    F0, F2
  2E0:  NOP
  2E4:  BC1F      .o2FC
  2E8:  NOP
  2EC:  LIF       F0, -380.0
  2F4:  NOP
  2F8:  SWC1      F0, 40 (S1)
        .o2FC
  2FC:  LWC1      F2, 38 (S1)
  300:  MUL.S     F2, F2, F2
  304:  NOP
  308:  LWC1      F0, 40 (S1)
  30C:  MUL.S     F0, F0, F0
  310:  NOP
  314:  ADD.S     F12, F2, F0
  318:  SQRT.S    F0, F12
  31C:  C.EQ.S    F0, F0
  320:  NOP
  324:  BC1T      .o334
  328:  NOP
  32C:  JAL       ~Func:sqrtf
  330:  NOP
        .o334
  334:  LW        A2, 38 (S1)
  338:  LW        A3, 40 (S1)
  33C:  MTC1      R0, F20
  340:  SWC1      F0, 38 (SP)
  344:  MOV.S     F12, F20
  348:  JAL       ~Func:atan2
  34C:  MOV.S     F14, F20
  350:  MOV.S     F22, F0
  354:  LWC1      F2, 38 (SP)
  358:  LAD       F0, $ConstDouble_802473E8_kzn_03
  360:  CVT.D.S   F2, F2
  364:  C.LT.D    F2, F0
  368:  NOP
  36C:  BC1F      .o380
  370:  COPY      A0, S0
  374:  LI        A2, 43988000
  378:  BEQ       R0, R0, .o3A0
  37C:  RESERVED
        .o380
  380:  LAD       F0, $ConstDouble_802473F0_kzn_03
  388:  C.LT.D    F0, F2
  38C:  NOP
  390:  BC1F      .o77C
  394:  NOP
  398:  LI        A2, 43BB8000
        .o3A0
  3A0:  MFC1      A3, F22
  3A4:  COPY      A1, S3
  3A8:  SWC1      F20, 38 (S1)
  3AC:  JAL       ~Func:add_vec2D_polar
  3B0:  SWC1      F20, 40 (S1)
  3B4:  BEQ       R0, R0, .o77C
  3B8:  NOP
        .o3BC
  3BC:  LW        V0, 0 (S1)
  3C0:  ANDI      V0, V0, 40
  3C4:  BNE       V0, R0, .o688
  3C8:  ADDIU     A1, SP, 20
  3CC:  ADDIU     S4, SP, 20
  3D0:  COPY      A1, S4
  3D4:  ADDIU     S3, SP, 24
  3D8:  LW        V0, 0 (S5)
  3DC:  LIF       F3, 2.78125
  3E4:  MTC1      R0, F2
  3E8:  LWC1      F0, 2C (V0)
  3EC:  LWC1      F6, 28 (V0)
  3F0:  LWC1      F4, 30 (V0)
  3F4:  CVT.D.S   F0, F0
  3F8:  ADD.D     F0, F0, F2
  3FC:  SWC1      F6, 20 (SP)
  400:  SWC1      F4, 28 (SP)
  404:  CVT.S.D   F0, F0
  408:  SWC1      F0, 24 (SP)
  40C:  SWC1      F20, 10 (SP)
  410:  SWC1      F22, 14 (SP)
  414:  LH        V0, A8 (S1)
  418:  COPY      A2, S3
  41C:  MTC1      V0, F0
  420:  NOP
  424:  CVT.S.W   F0, F0
  428:  SWC1      F0, 18 (SP)
  42C:  LH        V0, A6 (S1)
  430:  ADDIU     S0, SP, 28
  434:  MTC1      V0, F0
  438:  NOP
  43C:  CVT.S.W   F0, F0
  440:  SWC1      F0, 1C (SP)
  444:  LW        A0, 80 (S1)
  448:  JAL       ~Func:npc_test_move_simple_with_slipping
  44C:  COPY      A3, S0
  450:  BEQ       V0, R0, .o77C
  454:  COPY      A1, S4
  458:  LW        V0, 0 (S5)
  45C:  LAD       F2, $ConstDouble_802473F8_kzn_03
  464:  LWC1      F0, 2C (V0)
  468:  LWC1      F6, 28 (V0)
  46C:  LWC1      F4, 30 (V0)
  470:  CVT.D.S   F0, F0
  474:  ADD.D     F0, F0, F2
  478:  SWC1      F6, 20 (SP)
  47C:  SWC1      F4, 28 (SP)
  480:  CVT.S.D   F0, F0
  484:  SWC1      F0, 24 (SP)
  488:  SWC1      F20, 10 (SP)
  48C:  SWC1      F22, 14 (SP)
  490:  LH        V0, A8 (S1)
  494:  MTC1      V0, F0
  498:  NOP
  49C:  CVT.S.W   F0, F0
  4A0:  SWC1      F0, 18 (SP)
  4A4:  LH        V0, A6 (S1)
  4A8:  COPY      A2, S3
  4AC:  MTC1      V0, F0
  4B0:  NOP
  4B4:  CVT.S.W   F0, F0
  4B8:  SWC1      F0, 1C (SP)
  4BC:  LW        A0, 80 (S1)
  4C0:  JAL       ~Func:npc_test_move_simple_with_slipping
  4C4:  COPY      A3, S0
  4C8:  ADDIU     A1, SP, 2C
  4CC:  ADDIU     A2, SP, 30
  4D0:  ADDIU     A3, SP, 34
  4D4:  ADDIU     V1, SP, 38
  4D8:  LWC1      F2, 38 (S1)
  4DC:  LWC1      F0, 3C (S1)
  4E0:  LIF       F6, 200.0
  4E8:  CVT.D.S   F0, F0
  4EC:  SWC1      F2, 2C (SP)
  4F0:  LIF       F3, 3.390625
  4F8:  MTC1      R0, F2
  4FC:  LWC1      F4, 40 (S1)
  500:  ADD.D     F0, F0, F2
  504:  SWC1      F6, 38 (SP)
  508:  SWC1      F4, 34 (SP)
  50C:  CVT.S.D   F0, F0
  510:  SWC1      F0, 30 (SP)
  514:  SW        V1, 10 (SP)
  518:  LW        A0, 80 (S1)
  51C:  JAL       ~Func:npc_raycast_down_sides
  520:  COPY      S0, V0
  524:  BNE       S0, R0, .o598
  528:  NOP
  52C:  BEQ       V0, R0, .o598
  530:  NOP
  534:  LWC1      F2, 38 (SP)
  538:  LIF       F1, 3.3125
  540:  MTC1      R0, F0
  544:  CVT.D.S   F2, F2
  548:  C.LT.D    F0, F2
  54C:  NOP
  550:  BC1F      .o598
  554:  NOP
  558:  LIF       F1, 3.46875
  560:  MTC1      R0, F0
  564:  NOP
  568:  C.LT.D    F2, F0
  56C:  NOP
  570:  BC1F      .o598
  574:  NOP
  578:  LWC1      F2, 3C (S1)
  57C:  LWC1      F0, 30 (SP)
  580:  C.EQ.S    F2, F0
  584:  NOP
  588:  BC1T      .o598
  58C:  NOP
  590:  BEQ       R0, R0, .o77C
  594:  LI        S8, 1
        .o598
  598:  LA        S0, 800F7B30
  5A0:  LW        V0, 0 (S0)
  5A4:  LIF       F3, 2.5625
  5AC:  MTC1      R0, F2
  5B0:  LWC1      F0, 2C (V0)
  5B4:  LWC1      F6, 28 (V0)
  5B8:  LWC1      F4, 30 (V0)
  5BC:  CVT.D.S   F0, F0
  5C0:  ADD.D     F0, F0, F2
  5C4:  SWC1      F6, 20 (SP)
  5C8:  SWC1      F4, 28 (SP)
  5CC:  CVT.S.D   F0, F0
  5D0:  SWC1      F0, 24 (SP)
  5D4:  SWC1      F20, 10 (SP)
  5D8:  SWC1      F22, 14 (SP)
  5DC:  LH        V0, A8 (S1)
  5E0:  ADDIU     A1, SP, 20
  5E4:  MTC1      V0, F0
  5E8:  NOP
  5EC:  CVT.S.W   F0, F0
  5F0:  SWC1      F0, 18 (SP)
  5F4:  LH        V0, A6 (S1)
  5F8:  ADDIU     A2, SP, 24
  5FC:  MTC1      V0, F0
  600:  NOP
  604:  CVT.S.W   F0, F0
  608:  SWC1      F0, 1C (SP)
  60C:  LW        A0, 80 (S1)
  610:  JAL       ~Func:npc_test_move_simple_with_slipping
  614:  ADDIU     A3, SP, 28
  618:  LW        A2, 20 (SP)
  61C:  LW        V0, 0 (S0)
  620:  LW        A3, 28 (SP)
  624:  LWC1      F12, 28 (V0)
  628:  LWC1      F14, 30 (V0)
  62C:  JAL       ~Func:dist2D
  630:  LI        S7, 1
  634:  MOV.S     F20, F0
  638:  LW        V1, 0 (S0)
  63C:  LH        V0, A6 (S1)
  640:  MFC1      A3, F24
  644:  MTC1      V0, F8
  648:  NOP
  64C:  CVT.S.W   F8, F8
  650:  LWC1      F0, 28 (V1)
  654:  MFC1      A2, F8
  658:  ADDIU     A0, S1, 38
  65C:  SWC1      F0, 38 (S1)
  660:  LWC1      F0, 30 (V1)
  664:  ADDIU     A1, S1, 40
  668:  JAL       ~Func:add_vec2D_polar
  66C:  SWC1      F0, 40 (S1)
  670:  LH        V0, A6 (S1)
  674:  MTC1      V0, F0
  678:  NOP
  67C:  CVT.S.W   F0, F0
  680:  BEQ       R0, R0, .o76C
  684:  ADD.S     F20, F20, F0
        .o688
  688:  LW        V0, 0 (S5)
  68C:  LIF       F3, 2.78125
  694:  MTC1      R0, F2
  698:  LWC1      F0, 2C (V0)
  69C:  LWC1      F6, 28 (V0)
  6A0:  LWC1      F4, 30 (V0)
  6A4:  CVT.D.S   F0, F0
  6A8:  ADD.D     F0, F0, F2
  6AC:  SWC1      F6, 20 (SP)
  6B0:  SWC1      F4, 28 (SP)
  6B4:  CVT.S.D   F0, F0
  6B8:  SWC1      F0, 24 (SP)
  6BC:  SWC1      F20, 10 (SP)
  6C0:  SWC1      F22, 14 (SP)
  6C4:  LH        V0, A8 (S1)
  6C8:  MTC1      V0, F0
  6CC:  NOP
  6D0:  CVT.S.W   F0, F0
  6D4:  SWC1      F0, 18 (SP)
  6D8:  LH        V0, A6 (S1)
  6DC:  ADDIU     A2, SP, 24
  6E0:  MTC1      V0, F0
  6E4:  NOP
  6E8:  CVT.S.W   F0, F0
  6EC:  SWC1      F0, 1C (SP)
  6F0:  LW        A0, 80 (S1)
  6F4:  JAL       ~Func:npc_test_move_simple_with_slipping
  6F8:  ADDIU     A3, SP, 28
  6FC:  BEQ       V0, R0, .o77C
  700:  NOP
  704:  LW        A2, 20 (SP)
  708:  LW        V0, 0 (S5)
  70C:  LW        A3, 28 (SP)
  710:  LWC1      F12, 28 (V0)
  714:  JAL       ~Func:dist2D
  718:  LWC1      F14, 30 (V0)
  71C:  MOV.S     F20, F0
  720:  LW        V1, 0 (S5)
  724:  LH        V0, A6 (S1)
  728:  MFC1      A3, F24
  72C:  MTC1      V0, F8
  730:  NOP
  734:  CVT.S.W   F8, F8
  738:  LWC1      F0, 28 (V1)
  73C:  MFC1      A2, F8
  740:  COPY      A0, S0
  744:  SWC1      F0, 38 (S1)
  748:  LWC1      F0, 30 (V1)
  74C:  COPY      A1, S3
  750:  JAL       ~Func:add_vec2D_polar
  754:  SWC1      F0, 40 (S1)
  758:  LH        V0, A6 (S1)
  75C:  MTC1      V0, F0
  760:  NOP
  764:  CVT.S.W   F0, F0
  768:  ADD.S     F20, F20, F0
        .o76C
  76C:  MFC1      A2, F22
  770:  MFC1      A1, F20
  774:  JAL       ~Func:npc_move_heading
  778:  COPY      A0, S1
        .o77C
  77C:  LWC1      F0, 8 (S2)
  780:  CVT.S.W   F0, F0
  784:  MFC1      A1, F0
  788:  LWC1      F0, C (S2)
  78C:  CVT.S.W   F0, F0
  790:  MFC1      A2, F0
  794:  LWC1      F0, 40 (S1)
  798:  ADDIU     S0, S1, 38
  79C:  SWC1      F0, 10 (SP)
  7A0:  LWC1      F0, 10 (S2)
  7A4:  CVT.S.W   F0, F0
  7A8:  SWC1      F0, 14 (SP)
  7AC:  LWC1      F0, 14 (S2)
  7B0:  CVT.S.W   F0, F0
  7B4:  SWC1      F0, 18 (SP)
  7B8:  LW        A0, 4 (S2)
  7BC:  LW        A3, 38 (S1)
  7C0:  JAL       ~Func:is_point_within_region
  7C4:  ADDIU     S3, S1, 40
  7C8:  BEQ       V0, R0, .o934
  7CC:  NOP
  7D0:  LW        V1, 4 (S2)
  7D4:  BEQ       V1, R0, .o7EC
  7D8:  LI        V0, 1
  7DC:  BEQ       V1, V0, .o884
  7E0:  NOP
  7E4:  BEQ       R0, R0, .o934
  7E8:  NOP
        .o7EC
  7EC:  LWC1      F8, 8 (S2)
  7F0:  CVT.S.W   F8, F8
  7F4:  MFC1      A2, F8
  7F8:  LWC1      F8, C (S2)
  7FC:  CVT.S.W   F8, F8
  800:  LWC1      F12, 38 (S1)
  804:  LWC1      F14, 40 (S1)
  808:  MFC1      A3, F8
  80C:  JAL       ~Func:dist2D
  810:  NOP
  814:  LWC1      F2, 10 (S2)
  818:  CVT.S.W   F2, F2
  81C:  C.LT.S    F2, F0
  820:  NOP
  824:  BC1F      .o934
  828:  SWC1      F0, 38 (SP)
  82C:  LWC1      F12, 8 (S2)
  830:  CVT.S.W   F12, F12
  834:  LW        A2, 38 (S1)
  838:  LW        A3, 40 (S1)
  83C:  LWC1      F14, C (S2)
  840:  JAL       ~Func:atan2
  844:  CVT.S.W   F14, F14
  848:  COPY      A0, S0
  84C:  MFC1      A3, F0
  850:  LWC1      F0, 8 (S2)
  854:  CVT.S.W   F0, F0
  858:  SWC1      F0, 38 (S1)
  85C:  LWC1      F0, C (S2)
  860:  CVT.S.W   F0, F0
  864:  SWC1      F0, 40 (S1)
  868:  LWC1      F8, 10 (S2)
  86C:  CVT.S.W   F8, F8
  870:  MFC1      A2, F8
  874:  JAL       ~Func:add_vec2D_polar
  878:  COPY      A1, S3
  87C:  BEQ       R0, R0, .o934
  880:  NOP
        .o884
  884:  LW        V0, 8 (S2)
  888:  LW        V1, 10 (S2)
  88C:  LWC1      F0, 38 (S1)
  890:  ADDU      V0, V0, V1
  894:  MTC1      V0, F2
  898:  NOP
  89C:  CVT.S.W   F2, F2
  8A0:  C.LT.S    F2, F0
  8A4:  NOP
  8A8:  BC1TL     .o8B0
  8AC:  SWC1      F2, 38 (S1)
        .o8B0
  8B0:  LW        V0, 8 (S2)
  8B4:  LW        V1, 10 (S2)
  8B8:  LWC1      F0, 38 (S1)
  8BC:  SUBU      V0, V0, V1
  8C0:  MTC1      V0, F2
  8C4:  NOP
  8C8:  CVT.S.W   F2, F2
  8CC:  C.LT.S    F0, F2
  8D0:  NOP
  8D4:  BC1TL     .o8DC
  8D8:  SWC1      F2, 38 (S1)
        .o8DC
  8DC:  LW        V0, C (S2)
  8E0:  LW        V1, 14 (S2)
  8E4:  LWC1      F0, 40 (S1)
  8E8:  ADDU      V0, V0, V1
  8EC:  MTC1      V0, F2
  8F0:  NOP
  8F4:  CVT.S.W   F2, F2
  8F8:  C.LT.S    F2, F0
  8FC:  NOP
  900:  BC1TL     .o908
  904:  SWC1      F2, 40 (S1)
        .o908
  908:  LW        V0, C (S2)
  90C:  LW        V1, 14 (S2)
  910:  LWC1      F0, 40 (S1)
  914:  SUBU      V0, V0, V1
  918:  MTC1      V0, F2
  91C:  NOP
  920:  CVT.S.W   F2, F2
  924:  C.LT.S    F0, F2
  928:  NOP
  92C:  BC1TL     .o934
  930:  SWC1      F2, 40 (S1)
        .o934
  934:  BNE       S7, R0, .o9B4
  938:  NOP
  93C:  LW        V0, 0 (S1)
  940:  ANDI      V0, V0, 8
  944:  BEQ       V0, R0, .o954
  948:  ADDIU     A1, SP, 20
  94C:  BEQ       S8, R0, .o9B4
  950:  NOP
        .o954
  954:  ADDIU     A2, SP, 24
  958:  ADDIU     V0, SP, 38
  95C:  LWC1      F2, 38 (S1)
  960:  LWC1      F0, 3C (S1)
  964:  LIF       F6, 400.0
  96C:  CVT.D.S   F0, F0
  970:  SWC1      F2, 20 (SP)
  974:  LAD       F2, $ConstDouble_80247400_kzn_03
  97C:  LWC1      F4, 40 (S1)
  980:  ADD.D     F0, F0, F2
  984:  SWC1      F6, 38 (SP)
  988:  SWC1      F4, 28 (SP)
  98C:  CVT.S.D   F0, F0
  990:  SWC1      F0, 24 (SP)
  994:  SW        V0, 10 (SP)
  998:  LW        A0, 80 (S1)
  99C:  JAL       ~Func:npc_raycast_down_sides
  9A0:  ADDIU     A3, SP, 28
  9A4:  BEQ       V0, R0, .o9B4
  9A8:  NOP
  9AC:  LWC1      F0, 24 (SP)
  9B0:  SWC1      F0, 3C (S1)
        .o9B4
  9B4:  LWC1      F12, 38 (S1)
  9B8:  LAW       V0, 800F7B30
  9C0:  LWC1      F14, 40 (S1)
  9C4:  LW        A2, 28 (V0)
  9C8:  JAL       ~Func:atan2
  9CC:  LW        A3, 30 (V0)
  9D0:  COPY      A0, S1
  9D4:  LI        A1, 321
  9D8:  CLEAR     A2
  9DC:  JAL       ~Func:ai_enemy_play_sound
  9E0:  SWC1      F0, C (S1)
  9E4:  LW        V0, CC (S6)
  9E8:  LW        V0, 24 (V0)
  9EC:  SW        V0, 28 (S1)
  9F0:  LHU       V0, 96 (S6)
  9F4:  SH        V0, 8E (S1)
  9F8:  LW        T0, 80 (SP)
  9FC:  LI        V0, B
  A00:  SW        V0, 70 (T0)
        .oA04
  A04:  LW        RA, 64 (SP)
  A08:  LW        S8, 60 (SP)
  A0C:  LW        S7, 5C (SP)
  A10:  LW        S6, 58 (SP)
  A14:  LW        S5, 54 (SP)
  A18:  LW        S4, 50 (SP)
  A1C:  LW        S3, 4C (SP)
  A20:  LW        S2, 48 (SP)
  A24:  LW        S1, 44 (SP)
  A28:  LW        S0, 40 (SP)
  A2C:  LDC1      F24, 78 (SP)
  A30:  LDC1      F22, 70 (SP)
  A34:  LDC1      F20, 68 (SP)
  A38:  JR        RA
  A3C:  ADDIU     SP, SP, 80
}

#new:Function $Function_80242070_kzn_03 {
    0:  ADDIU     SP, SP, FFE0
    4:  SW        S1, 14 (SP)
    8:  COPY      S1, A0
    C:  SW        RA, 18 (SP)
   10:  SW        S0, 10 (SP)
   14:  LW        S0, 148 (S1)
   18:  JAL       ~Func:get_npc_unsafe
   1C:  LH        A0, 8 (S0)
   20:  COPY      A0, V0
   24:  LHU       V0, 8E (A0)
   28:  ADDIU     V0, V0, FFFF
   2C:  SH        V0, 8E (A0)
   30:  SLL       V0, V0, 10
   34:  LW        V1, 98 (S0)
   38:  SRA       V0, V0, 10
   3C:  SLT       V1, V1, V0
   40:  BNE       V1, R0, .o58
   44:  LUI       V1, E0EF
   48:  LW        V0, 0 (S0)
   4C:  ORI       V1, V1, FFFF
   50:  AND       V0, V0, V1
   54:  SW        V0, 0 (S0)
        .o58
   58:  LH        V0, 8E (A0)
   5C:  BNE       V0, R0, .o7C
   60:  NOP
   64:  LW        V0, CC (S0)
   68:  LW        V0, 28 (V0)
   6C:  SH        R0, 8E (A0)
   70:  SW        V0, 28 (A0)
   74:  LI        V0, C
   78:  SW        V0, 70 (S1)
        .o7C
   7C:  LW        RA, 18 (SP)
   80:  LW        S1, 14 (SP)
   84:  LW        S0, 10 (SP)
   88:  JR        RA
   8C:  ADDIU     SP, SP, 20
}

#new:Function $Function_80242100_kzn_03 {
    0:  ADDIU     SP, SP, FFC0
    4:  SW        S1, 34 (SP)
    8:  COPY      S1, A0
    C:  SW        RA, 38 (SP)
   10:  SW        S0, 30 (SP)
   14:  LW        S0, 148 (S1)
   18:  JAL       ~Func:get_npc_unsafe
   1C:  LH        A0, 8 (S0)
   20:  COPY      A1, V0
   24:  LHU       V0, 8E (A1)
   28:  ADDIU     V0, V0, 1
   2C:  SH        V0, 8E (A1)
   30:  SLL       V0, V0, 10
   34:  LW        V1, A0 (S0)
   38:  SRA       V0, V0, 10
   3C:  BNE       V0, V1, .o50
   40:  NOP
   44:  LW        V0, CC (S0)
   48:  LW        V0, 2C (V0)
   4C:  SW        V0, 28 (A1)
        .o50
   50:  LH        V1, 8E (A1)
   54:  LW        V0, A4 (S0)
        ADDIU	V0, R0, 9 % Frames to wait to land the hit after Piranha attacked
   58:  BNE       V1, V0, .o64
   5C:  LI        V0, 3
   60:  SW        V0, 6C (S0)
        .o64
   64:  LH        V0, 8E (A1)
   68:  LW        V1, 9C (S0)
   6C:  SLT       V0, V0, V1
   70:  BNE       V0, R0, .oEC
   74:  LI        V0, 4
   78:  SW        V0, 6C (S0)
   7C:  LI        V0, 8
   80:  LI        A0, 3
   84:  SH        V0, 8E (A1)
   88:  LW        V0, CC (S0)
   8C:  LH        V1, A8 (A1)
   90:  LIF       F0, 1.0
   98:  LIF       F2, 2.0
   A0:  LIF       F4, -20.0
   A8:  MTC1      V1, F6
   AC:  NOP
   B0:  CVT.S.W   F6, F6
   B4:  LW        V0, 0 (V0)
   B8:  MFC1      A3, F6
   BC:  CLEAR     A2
   C0:  SW        V0, 28 (A1)
   C4:  LI        V0, A
   C8:  SW        V0, 1C (SP)
   CC:  ADDIU     V0, SP, 28
   D0:  SWC1      F0, 10 (SP)
   D4:  SWC1      F2, 14 (SP)
   D8:  SWC1      F4, 18 (SP)
   DC:  JAL       ~Func:fx_emote
   E0:  SW        V0, 20 (SP)
   E4:  LI        V0, D
   E8:  SW        V0, 70 (S1)
        .oEC
   EC:  LW        RA, 38 (SP)
   F0:  LW        S1, 34 (SP)
   F4:  LW        S0, 30 (SP)
   F8:  JR        RA
   FC:  ADDIU     SP, SP, 40
}

#new:Function $Function_80242200_kzn_03 {
    0:  ADDIU     SP, SP, FFE0
    4:  SW        S1, 14 (SP)
    8:  COPY      S1, A0
    C:  SW        RA, 18 (SP)
   10:  SW        S0, 10 (SP)
   14:  LW        S0, 148 (S1)
   18:  JAL       ~Func:get_npc_unsafe
   1C:  LH        A0, 8 (S0)
   20:  COPY      V1, V0
   24:  LHU       V0, 8E (V1)
   28:  ADDIU     V0, V0, FFFF
   2C:  SH        V0, 8E (V1)
   30:  SLL       V0, V0, 10
   34:  BNE       V0, R0, .o4C
   38:  NOP
   3C:  LHU       V0, AA (S0)
   40:  SH        V0, 8E (V1)
   44:  LI        V0, E
   48:  SW        V0, 70 (S1)
        .o4C
   4C:  LW        RA, 18 (SP)
   50:  LW        S1, 14 (SP)
   54:  LW        S0, 10 (SP)
   58:  JR        RA
   5C:  ADDIU     SP, SP, 20
}

#new:Function $Function_80242260_kzn_03 {
    0:  ADDIU     SP, SP, FFB8
    4:  SW        S4, 40 (SP)
    8:  COPY      S4, A0
    C:  SW        RA, 44 (SP)
   10:  SW        S3, 3C (SP)
   14:  SW        S2, 38 (SP)
   18:  SW        S1, 34 (SP)
   1C:  SW        S0, 30 (SP)
   20:  LW        S1, 148 (S4)
   24:  COPY      S2, A1
   28:  LH        A0, 8 (S1)
   2C:  JAL       ~Func:get_npc_unsafe
   30:  COPY      S3, A2
   34:  COPY      S0, V0
   38:  LHU       V0, 8E (S0)
   3C:  ADDIU     V0, V0, FFFF
   40:  SH        V0, 8E (S0)
   44:  SLL       V0, V0, 10
   48:  BNE       V0, R0, .oCC
   4C:  COPY      A0, S3
   50:  SW        R0, 10 (SP)
   54:  LW        A2, C (S2)
   58:  LW        A3, 10 (S2)
   5C:  JAL       800490B4
   60:  COPY      A1, S1
   64:  BNEL      V0, R0, .oC8
   68:  SH        R0, 8E (S0)
   6C:  LI        A0, 2
   70:  COPY      A1, S0
   74:  CLEAR     A2
   78:  LH        V1, A8 (S0)
   7C:  LIF       F0, 1.0
   84:  LIF       F2, 2.0
   8C:  LIF       F4, -20.0
   94:  LI        V0, F
   98:  SW        V0, 1C (SP)
   9C:  MTC1      V1, F6
   A0:  NOP
   A4:  CVT.S.W   F6, F6
   A8:  MFC1      A3, F6
   AC:  ADDIU     V0, SP, 28
   B0:  SW        V0, 20 (SP)
   B4:  SWC1      F0, 10 (SP)
   B8:  SWC1      F2, 14 (SP)
   BC:  JAL       ~Func:fx_emote
   C0:  SWC1      F4, 18 (SP)
   C4:  SH        R0, 8E (S0)
        .oC8
   C8:  SW        R0, 70 (S4)
        .oCC
   CC:  LW        RA, 44 (SP)
   D0:  LW        S4, 40 (SP)
   D4:  LW        S3, 3C (SP)
   D8:  LW        S2, 38 (SP)
   DC:  LW        S1, 34 (SP)
   E0:  LW        S0, 30 (SP)
   E4:  JR        RA
   E8:  ADDIU     SP, SP, 48
}

#new:Function $Function_8024234C_kzn_03 {
    0:  ADDIU     SP, SP, FFB0
    4:  SW        S2, 38 (SP)
    8:  COPY      S2, A0
    C:  SW        RA, 48 (SP)
   10:  SW        S5, 44 (SP)
   14:  SW        S4, 40 (SP)
   18:  SW        S3, 3C (SP)
   1C:  SW        S1, 34 (SP)
   20:  SW        S0, 30 (SP)
   24:  LW        S1, 148 (S2)
   28:  LH        A0, 8 (S1)
   2C:  JAL       ~Func:get_npc_unsafe
   30:  COPY      S0, A1
   34:  LW        V1, C (S2)
   38:  COPY      A0, S2
   3C:  LW        A1, 0 (V1)
   40:  JAL       ~Func:get_variable
   44:  COPY      S5, V0
   48:  SW        R0, 10 (SP)
   4C:  LW        V1, D0 (S1)
   50:  LW        V1, 30 (V1)
   54:  SW        V1, 14 (SP)
   58:  LW        V1, D0 (S1)
   5C:  LW        V1, 1C (V1)
   60:  SW        V1, 18 (SP)
   64:  LW        V1, D0 (S1)
   68:  LW        V1, 24 (V1)
   6C:  SW        V1, 1C (SP)
   70:  LW        V1, D0 (S1)
   74:  LW        V1, 28 (V1)
   78:  ADDIU     S4, SP, 10
   7C:  SW        V1, 20 (SP)
   80:  LW        V1, D0 (S1)
   84:  LIF       F0, 200.0
   8C:  LW        V1, 2C (V1)
   90:  COPY      S3, V0
   94:  SWC1      F0, 28 (SP)
   98:  SH        R0, 2C (SP)
   9C:  BNE       S0, R0, .oB4
   A0:  SW        V1, 24 (SP)
   A4:  LW        V0, B0 (S1)
   A8:  ANDI      V0, V0, 4
   AC:  BEQ       V0, R0, .oF4
   B0:  NOP
        .oB4
   B4:  SW        R0, 70 (S2)
   B8:  SH        R0, 8E (S5)
   BC:  LW        V0, CC (S1)
   C0:  LW        V0, 0 (V0)
   C4:  SW        V0, 28 (S5)
   C8:  LW        V0, B0 (S1)
   CC:  ANDI      V0, V0, 4
   D0:  BEQ       V0, R0, .oF4
   D4:  SW        R0, 6C (S1)
   D8:  LI        V0, 63
   DC:  SW        V0, 70 (S2)
   E0:  SW        R0, 74 (S2)
   E4:  LW        V0, B0 (S1)
   E8:  LI        V1, FFFB
   EC:  AND       V0, V0, V1
   F0:  SW        V0, B0 (S1)
        .oF4
   F4:  LW        V1, 70 (S2)
   F8:  LI        S0, B
   FC:  BEQ       V1, S0, .o1A8
  100:  SLTI      V0, V1, C
  104:  BEQ       V0, R0, .o13C
  108:  LI        V0, 1
  10C:  BEQ       V1, V0, .o178
  110:  SLTI      V0, V1, 2
  114:  BEQ       V0, R0, .o12C
  118:  LI        V0, A
  11C:  BEQ       V1, R0, .o16C
  120:  COPY      A0, S2
  124:  BEQ       R0, R0, .o228
  128:  NOP
        .o12C
  12C:  BEQ       V1, V0, .o190
  130:  COPY      A0, S2
  134:  BEQ       R0, R0, .o228
  138:  NOP
        .o13C
  13C:  LI        V0, D
  140:  BEQ       V1, V0, .o1E8
  144:  SLT       V0, V1, V0
  148:  BNE       V0, R0, .o1CC
  14C:  COPY      A0, S2
  150:  LI        V0, E
  154:  BEQ       V1, V0, .o20C
  158:  LI        V0, 63
  15C:  BEQ       V1, V0, .o220
  160:  NOP
  164:  BEQ       R0, R0, .o228
  168:  NOP
        .o16C
  16C:  COPY      A1, S3
  170:  JAL       $Function_802414C8_kzn_03
  174:  COPY      A2, S4
        .o178
  178:  COPY      A0, S2
  17C:  COPY      A1, S3
  180:  JAL       $Function_80241534_kzn_03
  184:  COPY      A2, S4
  188:  BEQ       R0, R0, .o228
  18C:  NOP
        .o190
  190:  COPY      A1, S3
  194:  JAL       $Function_80241630_kzn_03
  198:  COPY      A2, S4
  19C:  LW        V0, 70 (S2)
  1A0:  BNE       V0, S0, .o228
  1A4:  NOP
        .o1A8
  1A8:  COPY      A0, S2
  1AC:  COPY      A1, S3
  1B0:  JAL       $Function_80242070_kzn_03
  1B4:  COPY      A2, S4
  1B8:  LW        V1, 70 (S2)
  1BC:  LI        V0, C
  1C0:  BNE       V1, V0, .o228
  1C4:  NOP
  1C8:  COPY      A0, S2
        .o1CC
  1CC:  COPY      A1, S3
  1D0:  JAL       $Function_80242100_kzn_03
  1D4:  COPY      A2, S4
  1D8:  LW        V1, 70 (S2)
  1DC:  LI        V0, D
  1E0:  BNE       V1, V0, .o228
  1E4:  NOP
        .o1E8
  1E8:  COPY      A0, S2
  1EC:  COPY      A1, S3
  1F0:  JAL       $Function_80242200_kzn_03
  1F4:  COPY      A2, S4
  1F8:  LW        V1, 70 (S2)
  1FC:  LI        V0, E
  200:  BNE       V1, V0, .o228
  204:  NOP
  208:  COPY      A0, S2
        .o20C
  20C:  COPY      A1, S3
  210:  JAL       $Function_80242260_kzn_03
  214:  COPY      A2, S4
  218:  BEQ       R0, R0, .o228
  21C:  NOP
        .o220
  220:  JAL       8004A73C
  224:  COPY      A0, S2
        .o228
  228:  LW        RA, 48 (SP)
  22C:  LW        S5, 44 (SP)
  230:  LW        S4, 40 (SP)
  234:  LW        S3, 3C (SP)
  238:  LW        S2, 38 (SP)
  23C:  LW        S1, 34 (SP)
  240:  LW        S0, 30 (SP)
  244:  CLEAR     V0
  248:  JR        RA
  24C:  ADDIU     SP, SP, 50
}

#new:AISettings $AISettings_80243EE0_kzn_03 {
    0.0 % move speed
    30` % move time
    30` % wait time
  150.0 % alert radius
    0.0
    1`
    0.0 % chase speed
    0`
    0`
    0.0 % chase radius
    0.0
    0`
}

#new:Script $Script_NpcAI_80243F10_kzn_03 {
    0:  Call  SetSelfVar    ( 00000007 00000001 )
   14:  Call  SetSelfVar    ( 00000008 0000000A )
   28:  Call  SetSelfVar    ( 00000009 00000009 )
   3C:  Call  SetSelfVar    ( 0000000A 0000000C )
   50:  Call  SetSelfVar    ( 0000000B 00000007 )
   64:  Call  SetSelfVar    ( 0000000C 0000001E )
   78:  Call  SetSelfVar    ( 0000000D 0000000F )
   8C:  Call  SetSelfVar    ( 0000000E 00000012 )
   A0:  Call  SetSelfVar    ( 0000000F 0000000F )
   B4:  Call  $Function_8024234C_kzn_03 ( $AISettings_80243EE0_kzn_03 )
   C4:  Return
   CC:  End
}

#new:NpcSettings $NpcSettings_80244070_mim_01 {
00000000 0020001A 00000000 00000000 $Script_NpcAI_80243F10_kzn_03 80077F70 00000000 8007809C 
00000000 00000000 000B0000 
}

#new:ConstDouble $ConstDouble_802473D8_kzn_03 {
380.000000d
}

#new:ConstDouble $ConstDouble_802473E0_kzn_03 {
-380.000000d
}

#new:ConstDouble $ConstDouble_802473E8_kzn_03 {
305.000000d
}

#new:ConstDouble $ConstDouble_802473F0_kzn_03 {
375.000000d
}

#new:ConstDouble $ConstDouble_802473F8_kzn_03 {
45.000000d
}

#new:ConstDouble $ConstDouble_80247400_kzn_03 {
150.000000d
}

% HitBox

#new:Function $Function_80240FB4_kzn_03 {
    0:  ADDIU     SP, SP, FFD0
    4:  SW        S4, 28 (SP)
    8:  COPY      S4, A0
    C:  SW        RA, 2C (SP)
   10:  SW        S3, 24 (SP)
   14:  SW        S2, 20 (SP)
   18:  SW        S1, 1C (SP)
   1C:  SW        S0, 18 (SP)
   20:  LW        S1, 148 (S4)
   24:  LH        A0, 8 (S1)
   28:  JAL       ~Func:get_npc_unsafe
   2C:  COPY      S0, A1
   30:  BNE       S0, R0, .o48
   34:  COPY      S2, V0
   38:  LW        V0, B0 (S1)
   3C:  ANDI      V0, V0, 4
   40:  BEQ       V0, R0, .o98
   44:  NOP
        .o48
   48:  SW        R0, 70 (S4)
   4C:  LW        V0, 0 (S2)
   50:  LUI       V1, 1F30
   54:  SH        R0, 8E (S2)
   58:  ORI       V0, V0, 102
   5C:  SW        V0, 0 (S2)
   60:  LW        V0, 0 (S1)
   64:  LIF       F0, -1000.0
   6C:  OR        V0, V0, V1
   70:  SW        V0, 0 (S1)
   74:  SW        R0, 38 (S2)
   78:  SWC1      F0, 3C (S2)
   7C:  SW        R0, 40 (S2)
   80:  LW        V1, B0 (S1)
   84:  ANDI      V0, V1, 4
   88:  BEQ       V0, R0, .o98
   8C:  LI        V0, FFFB
   90:  AND       V0, V1, V0
   94:  SW        V0, B0 (S1)
        .o98
   98:  LW        S3, 70 (S4)
   9C:  BEQ       S3, R0, .oB4
   A0:  LI        V0, 1
   A4:  BEQ       S3, V0, .o1C8
   A8:  NOP
   AC:  BEQ       R0, R0, .o23C
   B0:  NOP
        .oB4
   B4:  LH        A0, 8 (S1)
   B8:  JAL       ~Func:get_enemy
   BC:  ADDIU     A0, A0, FFFF
   C0:  COPY      S0, V0
   C4:  JAL       ~Func:get_npc_unsafe
   C8:  LH        A0, 8 (S0)
   CC:  LI        V1, 1
   D0:  COPY      S3, V0
   D4:  SB        V1, 7 (S1)
   D8:  LW        V1, 6C (S0)
   DC:  LI        V0, 3
   E0:  BNE       V1, V0, .o23C
   E4:  NOP
   E8:  LW        A1, A8 (S1)
   EC:  BEQ       A1, R0, .oFC
   F0:  COPY      A0, S3
   F4:  JAL       ~Func:ai_enemy_play_sound
   F8:  CLEAR     A2
        .oFC
   FC:  ADDIU     A0, SP, 10
  100:  LWC1      F8, 70 (S1)
  104:  CVT.S.W   F8, F8
  108:  LWC1      F2, 34 (S3)
  10C:  LIF       F0, 270.0
  114:  MFC1      A2, F8
  118:  SUB.S     F0, F0, F2
  11C:  LWC1      F6, 38 (S3)
  120:  LWC1      F4, 40 (S3)
  124:  MFC1      A3, F0
  128:  ADDIU     A1, SP, 14
  12C:  SWC1      F6, 10 (SP)
  130:  JAL       ~Func:add_vec2D_polar
  134:  SWC1      F4, 14 (SP)
  138:  LWC1      F0, 10 (SP)
  13C:  TRUNC.W.S F8, F0
  140:  MFC1      V0, F8
  144:  SWC1      F0, 38 (S2)
  148:  SH        V0, 10 (S1)
  14C:  LWC1      F0, 3C (S3)
  150:  LWC1      F2, 6C (S1)
  154:  CVT.S.W   F2, F2
  158:  ADD.S     F0, F0, F2
  15C:  LAW       V1, 800F7B30
  164:  SWC1      F0, 3C (S2)
  168:  LWC1      F2, 14 (SP)
  16C:  TRUNC.W.S F8, F0
  170:  MFC1      V0, F8
  174:  NOP
  178:  SH        V0, 12 (S1)
  17C:  TRUNC.W.S F8, F2
  180:  MFC1      V0, F8
  184:  SWC1      F2, 40 (S2)
  188:  SH        V0, 14 (S1)
  18C:  LW        A2, 28 (V1)
  190:  LW        A3, 30 (V1)
  194:  LWC1      F12, 38 (S2)
  198:  JAL       ~Func:atan2
  19C:  LWC1      F14, 40 (S2)
  1A0:  LUI       V1, E0EF
  1A4:  SWC1      F0, C (S2)
  1A8:  LW        V0, 0 (S1)
  1AC:  ORI       V1, V1, FFFF
  1B0:  AND       V0, V0, V1
  1B4:  SW        V0, 0 (S1)
  1B8:  LI        V0, 1
  1BC:  SH        R0, 8E (S2)
  1C0:  BEQ       R0, R0, .o23C
  1C4:  SW        V0, 70 (S4)
        .o1C8
  1C8:  LH        A0, 8 (S1)
  1CC:  JAL       ~Func:get_enemy
  1D0:  ADDIU     A0, A0, FFFF
  1D4:  COPY      S0, V0
  1D8:  JAL       ~Func:get_npc_unsafe
  1DC:  LH        A0, 8 (S0)
  1E0:  LHU       V0, 8E (S2)
  1E4:  ADDIU     V0, V0, 1
  1E8:  SH        V0, 8E (S2)
  1EC:  SLL       V0, V0, 10
  1F0:  LW        V1, 7C (S1)
  1F4:  SRA       V0, V0, 10
  1F8:  SLT       V0, V0, V1
  1FC:  BEQL      V0, R0, .o204
  200:  SB        R0, 7 (S1)
        .o204
  204:  LW        V1, 6C (S0)
  208:  LI        V0, 4
  20C:  BNE       V1, V0, .o23C
  210:  LUI       V0, 1F10
  214:  LW        V1, 0 (S1)
  218:  LIF       F0, -1000.0
  220:  OR        V1, V1, V0
  224:  SW        V1, 0 (S1)
  228:  SW        R0, 38 (S2)
  22C:  SWC1      F0, 3C (S2)
  230:  SW        R0, 40 (S2)
  234:  SB        S3, 7 (S1)
  238:  SW        R0, 70 (S4)
        .o23C
  23C:  LW        RA, 2C (SP)
  240:  LW        S4, 28 (SP)
  244:  LW        S3, 24 (SP)
  248:  LW        S2, 20 (SP)
  24C:  LW        S1, 1C (SP)
  250:  LW        S0, 18 (SP)
  254:  CLEAR     V0
  258:  JR        RA
  25C:  ADDIU     SP, SP, 30
}

#new:Script $Script_80243E24_kzn_03 {
    0:  Call  GetBattleOutcome  ( *Var0 )
   10:  Switch  *Var0 
   1C:  	Case  ==  .Outcome:PlayerWon % 0
   28:  		Call  RemoveNpc ( .Npc:Self )
   38:  	Case  ==  .Outcome:PlayerFled % 2
   44:  		Call  SetNpcPos ( .Npc:Self  0`  -1000`  0` )
   60:  		Call  80045900  ( 00000001 )
   70:  	Case  ==  .Outcome:EnemyFled % 3
   7C:  		Call  SetEnemyFlagBits  ( .Npc:Self 00000010 00000001 )
   94:  		Call  RemoveNpc ( .Npc:Self )
   A4:  EndSwitch
   AC:  Return
   B4:  End
}

#new:Script $Script_NpcAI_80244010_kzn_03 {
    0:  Call  EnableNpcShadow   ( .Npc:Self .False )
   14:  Call  SetSelfVar    ( 00000000 0000000E )
   28:  Call  SetSelfVar    ( 00000001 0000001C )
   3C:  Call  SetSelfVar    ( 00000004 00000003 )
   50:  Call  SetSelfVar    ( 0000000F 000020DE )
   64:  Call  $Function_80240FB4_kzn_03 ( )
   70:  Return
   78:  End
}

#new:NpcSettings $NpcSettings_802441A8_mim_01 {
00000000 00120012 00000000 00000000 $Script_NpcAI_80244010_kzn_03 00000000 00000000 $Script_80243E24_kzn_03 
00000000 00000000 000B0008 
}


%============

% Panners

#new:Script $Script_SetupTexturePan
{
	Call     802C9000 	( ~Model:water 0 )
	Call     802C9000 	( ~Model:logFX 1 )
	Thread
		Set  *Var[0] 0
		Set  *Var[1] 0
		Set  *Var[2] 78
		Set  *Var[3] 0
		Set  *Var[4] 0
		Set  *Var[5] 0
		Set  *Var[6] 1
		Set  *Var[7] 0
		Set  *Var[8] 0
		Set  *Var[9] 0
		Set  *Var[A] 0
		Set  *Var[B] 0
		Set  *Var[C] 0
		Exec $Script_TexturePan_Update
	EndThread
	Thread
		Set  *Var[0] 1
		Set  *Var[1] 0
		Set  *Var[2] C8
		Set  *Var[3] 0
		Set  *Var[4] 0
		Set  *Var[5] 0
		Set  *Var[6] 1
		Set  *Var[7] 0
		Set  *Var[8] 0
		Set  *Var[9] 0
		Set  *Var[A] 0
		Set  *Var[B] 0
		Set  *Var[C] 0
		Exec $Script_TexturePan_Update
	EndThread
	Return
	End
}

#new:Script $Script_TexturePan_Update
{
    SetGroup  00000000
    If  *Var[5]  ==  00000001
        If  *Var[6]  ==  00000001
            If  *Var[7]  ==  00000001
                If  *Var[8]  ==  00000001
                    Call  $Function_TexturePan_Simple ( )
                    Return
                EndIf
            EndIf
        EndIf
    EndIf
    Call  $Function_TexturePan_Complex ( )
    Return
    End
}

#new:Function $Function_TexturePan_Simple
{
    ADDIU       SP, SP, FFE8
    SW          S0, 10 (SP)
    COPY        S0, A0
    SW          RA, 14 (SP)
    LW          V1, A8 (S0)
    LW          V0, 88 (S0)
    ADDU        V1, V1, V0
    BGEZ        V1, .o30
    SW          V1, A8 (S0)
    LUI         V0, 2
    BEQ         R0, R0, .o40
    ADDU        V0, V1, V0
    .o30
    LUI         A0, 2
    SLT         V0, A0, V1
    BEQ         V0, R0, .o44
    SUBU        V0, V1, A0
    .o40
    SW          V0, A8 (S0)
    .o44
    LW          V1, AC (S0)
    LW          V0, 8C (S0)
    ADDU        V1, V1, V0
    BGEZ        V1, .o64
    SW          V1, AC (S0)
    LUI         V0, 2
    BEQ         R0, R0, .o74
    ADDU        V0, V1, V0
    .o64
    LUI         A0, 2
    SLT         V0, A0, V1
    BEQ         V0, R0, .o78
    SUBU        V0, V1, A0
    .o74
    SW          V0, AC (S0)
    .o78
    LW          V1, B0 (S0)
    LW          V0, 90 (S0)
    ADDU        V1, V1, V0
    BGEZ        V1, .o98
    SW          V1, B0 (S0)
    LUI         V0, 2
    BEQ         R0, R0, .oA8
    ADDU        V0, V1, V0
    .o98
    LUI         A0, 2
    SLT         V0, A0, V1
    BEQ         V0, R0, .oAC
    SUBU        V0, V1, A0
    .oA8
    SW          V0, B0 (S0)
    .oAC
    LW          V1, B4 (S0)
    LW          V0, 94 (S0)
    ADDU        V1, V1, V0
    BGEZ        V1, .oCC
    SW          V1, B4 (S0)
    LUI         V0, 2
    BEQ         R0, R0, .oDC
    ADDU        V0, V1, V0
    .oCC
    LUI         A0, 2
    SLT         V0, A0, V1
    BEQ         V0, R0, .oE0
    SUBU        V0, V1, A0
    .oDC
    SW          V0, B4 (S0)
    .oE0
    LW          A0, 84 (S0)
    JAL         8011BC1C
    LW          A1, A8 (S0)
    LW          A0, 84 (S0)
    JAL         8011BC34
    LW          A1, AC (S0)
    LW          A0, 84 (S0)
    JAL         8011BC4C
    LW          A1, B0 (S0)
    LW          A0, 84 (S0)
    JAL         8011BC64
    LW          A1, B4 (S0)
    LW          RA, 14 (SP)
    LW          S0, 10 (SP)
    CLEAR       V0
    JR          RA
    ADDIU       SP, SP, 18
}

#new:Function $Function_TexturePan_Complex
{
    ADDIU       SP, SP, FFE8
    SW          S0, 10 (SP)
    COPY        S0, A0
    BEQ         A1, R0, .o24
    SW          RA, 14 (SP)
    SW          R0, 70 (S0)
    SW          R0, 74 (S0)
    SW          R0, 78 (S0)
    SW          R0, 7C (S0)
    .o24
    LW          V0, 70 (S0)
    BNE         V0, R0, .o64
    NOP
    LW          V1, A8 (S0)
    LW          V0, 88 (S0)
    ADDU        V1, V1, V0
    BGEZ        V1, .o50
    SW          V1, A8 (S0)
    LUI         V0, 2
    BEQ         R0, R0, .o60
    ADDU        V0, V1, V0
    .o50
    LUI         A0, 2
    SLT         V0, A0, V1
    BEQ         V0, R0, .o64
    SUBU        V0, V1, A0
    .o60
    SW          V0, A8 (S0)
    .o64
    LW          V0, 74 (S0)
    BNE         V0, R0, .oA4
    NOP
    LW          V1, AC (S0)
    LW          V0, 8C (S0)
    ADDU        V1, V1, V0
    BGEZ        V1, .o90
    SW          V1, AC (S0)
    LUI         V0, 2
    BEQ         R0, R0, .oA0
    ADDU        V0, V1, V0
    .o90
    LUI         A0, 2
    SLT         V0, A0, V1
    BEQ         V0, R0, .oA4
    SUBU        V0, V1, A0
    .oA0
    SW          V0, AC (S0)
    .oA4
    LW          V0, 78 (S0)
    BNE         V0, R0, .oE4
    NOP
    LW          V1, B0 (S0)
    LW          V0, 90 (S0)
    ADDU        V1, V1, V0
    BGEZ        V1, .oD0
    SW          V1, B0 (S0)
    LUI         V0, 2
    BEQ         R0, R0, .oE0
    ADDU        V0, V1, V0
    .oD0
    LUI         A0, 2
    SLT         V0, A0, V1
    BEQ         V0, R0, .oE4
    SUBU        V0, V1, A0
    .oE0
    SW          V0, B0 (S0)
    .oE4
    LW          V0, 7C (S0)
    BNE         V0, R0, .o124
    NOP
    LW          V1, B4 (S0)
    LW          V0, 94 (S0)
    ADDU        V1, V1, V0
    BGEZ        V1, .o110
    SW          V1, B4 (S0)
    LUI         V0, 2
    BEQ         R0, R0, .o120
    ADDU        V0, V1, V0
    .o110
    LUI         A0, 2
    SLT         V0, A0, V1
    BEQ         V0, R0, .o124
    SUBU        V0, V1, A0
    .o120
    SW          V0, B4 (S0)
    .o124
    LW          A0, 84 (S0)
    JAL         8011BC1C
    LW          A1, A8 (S0)
    LW          A0, 84 (S0)
    JAL         8011BC34
    LW          A1, AC (S0)
    LW          A0, 84 (S0)
    JAL         8011BC4C
    LW          A1, B0 (S0)
    LW          A0, 84 (S0)
    JAL         8011BC64
    LW          A1, B4 (S0)
    LW          V0, 70 (S0)
    LW          V1, 78 (S0)
    LW          A0, 98 (S0)
    ADDIU       V0, V0, 1
    SW          V0, 70 (S0)
    LW          V0, 74 (S0)
    ADDIU       V1, V1, 1
    SW          V1, 78 (S0)
    LW          V1, 70 (S0)
    ADDIU       V0, V0, 1
    SW          V0, 74 (S0)
    LW          V0, 7C (S0)
    SLT         V1, V1, A0
    ADDIU       V0, V0, 1
    BNE         V1, R0, .o198
    SW          V0, 7C (S0)
    SW          R0, 70 (S0)
    .o198
    LW          V0, 74 (S0)
    LW          V1, 9C (S0)
    SLT         V0, V0, V1
    BEQL        V0, R0, .o1AC
    SW          R0, 74 (S0)
    .o1AC
    LW          V0, 78 (S0)
    LW          V1, A0 (S0)
    SLT         V0, V0, V1
    BEQL        V0, R0, .o1C0
    SW          R0, 78 (S0)
    .o1C0
    LW          V0, 7C (S0)
    LW          V1, A4 (S0)
    SLT         V0, V0, V1
    BEQL        V0, R0, .o1D4
    SW          R0, 7C (S0)
    .o1D4
    LW          RA, 14 (SP)
    LW          S0, 10 (SP)
    CLEAR       V0
    JR          RA
    ADDIU       SP, SP, 18
}

% Bushes

#new:TreeModelList $BushModels_bush1
{
	1`
	~Model:bush
}

#new:TreeEffectVectors $FoliageFXPos_bush1
{
	1`
	~Vec3d:Bush6_Drop1
}

#new:SearchBushEvent $SearchBushData_bush1
{
	$BushModels_bush1
	00000000
	$FoliageFXPos_bush1
	00000000
}

#new:TreeModelList $BushModels_bush2
{
	1`
	~Model:bush2
}

#new:TreeEffectVectors $FoliageFXPos_bush2
{
	1`
	~Vec3d:Bush2_Drop1
}

#new:TreeDropList $FoliageDrops_bush2
{
	1`
	.Item:StarPiece ~Vec3d:Bush2_Drop1 00000006 *GF_TYD02_Item1 .False
}

#new:SearchBushEvent $SearchBushData_bush2
{
	$BushModels_bush2
	$FoliageDrops_bush2
	$FoliageFXPos_bush2
	00000000
}

#new:TreeModelList $BushModels_bush3
{
	1`
	~Model:bush3
}

#new:TreeEffectVectors $FoliageFXPos_bush3
{
	1`
	~Vec3d:Bush6_Drop1
}

#new:SearchBushEvent $SearchBushData_bush3
{
	$BushModels_bush3
	00000000
	$FoliageFXPos_bush3
	00000000
}

#new:TreeModelList $BushModels_bush4
{
	1`
	~Model:bush4
}

#new:TreeEffectVectors $FoliageFXPos_bush4
{
	1`
	~Vec3d:Bush6_Drop1
}

#new:SearchBushEvent $SearchBushData_bush4
{
	$BushModels_bush4
	00000000
	$FoliageFXPos_bush4
	00000000
}

#new:TreeModelList $BushModels_bush5
{
	1`
	~Model:bush5
}

#new:TreeEffectVectors $FoliageFXPos_bush5
{
	1`
	~Vec3d:Bush6_Drop1
}

#new:SearchBushEvent $SearchBushData_bush5
{
	$BushModels_bush5
	00000000
	$FoliageFXPos_bush5
	00000000
}

#new:TreeModelList $BushModels_bush6
{
	1`
	~Model:bush6
}

#new:TreeEffectVectors $FoliageFXPos_bush6
{
	1`
	~Vec3d:Bush6_Drop1
}

#new:TreeDropList $FoliageDrops_bush6
{
	1`
	.Item:ShrinkStomp ~Vec3d:Bush6_Drop1 00000006 *GF_TYD02_Item2 .False
}

#new:SearchBushEvent $SearchBushData_bush6
{
	$BushModels_bush6
	$FoliageDrops_bush6
	$FoliageFXPos_bush6
	00000000
}

#new:Script $Script_BindFoliage
{
	Set   *Var[0]  $SearchBushData_bush1
	Bind  $Script_Foliage_SearchBush .Trigger:WallPressA ~Collider:bush1 00000001 00000000
	Set   *Var[0]  $SearchBushData_bush2
	Bind  $Script_Foliage_SearchBush .Trigger:WallPressA ~Collider:bush2 00000001 00000000
	Set   *Var[0]  $SearchBushData_bush3
	Bind  $Script_Foliage_SearchBush .Trigger:WallPressA ~Collider:bush3 00000001 00000000
	Set   *Var[0]  $SearchBushData_bush4
	Bind  $Script_Foliage_SearchBush .Trigger:WallPressA ~Collider:bush4 00000001 00000000
	Set   *Var[0]  $SearchBushData_bush5
	Bind  $Script_Foliage_SearchBush .Trigger:WallPressA ~Collider:bush5 00000001 00000000
	Set   *Var[0]  $SearchBushData_bush6
	Bind  $Script_Foliage_SearchBush .Trigger:WallPressA ~Collider:bush6 00000001 00000000
	Return
	End
}

#new:Function $Function_Foliage_SetupShearMatrix
% args: matrix4f* mat, float scale, float xamt, float zamt
{
    0:  ADDIU     SP, SP, FFD0
    4:  SDC1      F20, 18 (SP)
    8:  MTC1      A1, F20
    C:  SDC1      F22, 20 (SP)
   10:  MTC1      A2, F22
   14:  SW        S0, 10 (SP)
   18:  SDC1      F24, 28 (SP)
   1C:  MTC1      A3, F24
   20:  SW        RA, 14 (SP)
   24:  JAL       ~Func:guMtxIdentF
   28:  COPY      S0, A0
   2C:  MUL.S     F22, F20, F22
   30:  NOP
   34:  MUL.S     F20, F20, F24
   38:  NOP
   3C:  LIF       F0, 1.0
   44:  NOP
   48:  SWC1      F0, 14 (S0)
   4C:  SWC1      F22, 10 (S0)
   50:  SWC1      F20, 18 (S0)
   54:  LW        RA, 14 (SP)
   58:  LW        S0, 10 (SP)
   5C:  LDC1      F24, 28 (SP)
   60:  LDC1      F22, 20 (SP)
   64:  LDC1      F20, 18 (SP)
   68:  JR        RA
   6C:  ADDIU     SP, SP, 30
}

#new:Function $Function_Foliage_TransformModel
% args: (api) model* mdl, float scale, float dx, float dy, float dz
{
    0:  ADDIU     SP, SP, FF78
    4:  SW        S1, 54 (SP)
    8:  COPY      S1, A0
    C:  SW        RA, 5C (SP)
   10:  SW        S2, 58 (SP)
   14:  SW        S0, 50 (SP)
   18:  SDC1      F28, 80 (SP)
   1C:  SDC1      F26, 78 (SP)
   20:  SDC1      F24, 70 (SP)
   24:  SDC1      F22, 68 (SP)
   28:  SDC1      F20, 60 (SP)
   2C:  LW        S0, C (S1)
   30:  LW        A1, 0 (S0)
   34:  JAL       ~Func:get_variable
   38:  ADDIU     S0, S0, 4
   3C:  JAL       ~Func:get_model_list_index_from_tree_index
   40:  COPY      A0, V0
   44:  LW        A1, 0 (S0)
   48:  ADDIU     S0, S0, 4
   4C:  COPY      A0, S1
   50:  JAL       ~Func:get_float_variable
   54:  COPY      S2, V0
   58:  LW        A1, 0 (S0)
   5C:  ADDIU     S0, S0, 4
   60:  COPY      A0, S1
   64:  JAL       ~Func:get_float_variable
   68:  MOV.S     F28, F0
   6C:  LW        A1, 0 (S0)
   70:  ADDIU     S0, S0, 4
   74:  COPY      A0, S1
   78:  JAL       ~Func:get_float_variable
   7C:  MOV.S     F26, F0
   80:  COPY      A0, S1
   84:  LW        A1, 0 (S0)
   88:  JAL       ~Func:get_float_variable
   8C:  MOV.S     F22, F0
   90:  COPY      A0, S2
   94:  JAL       ~Func:get_model_from_list_index
   98:  MOV.S     F24, F0
   9C:  COPY      S1, V0
   A0:  LHU       V0, 0 (S1)
   A4:  ANDI      V0, V0, 400
   A8:  BNE       V0, R0, .o124
   AC:  ADDIU     S0, S1, 58
   B0:  MTC1      R0, F20
   B4:  MFC1      A2, F22
   B8:  MFC1      A1, F20
   BC:  MFC1      A3, F20
   C0:  JAL       ~Func:guTranslateF
   C4:  COPY      A0, S0
   C8:  MFC1      A1, F28
   CC:  MFC1      A2, F26
   D0:  MFC1      A3, F24
   D4:  JAL       $Function_Foliage_SetupShearMatrix
   D8:  ADDIU     A0, SP, 10
   DC:  ADDIU     A0, SP, 10
   E0:  COPY      A1, S0
   E4:  JAL       ~Func:guMtxCatF
   E8:  COPY      A2, S0
   EC:  ADDIU     A0, SP, 10
   F0:  NEG.S     F22, F22
   F4:  MFC1      A1, F20
   F8:  MFC1      A2, F22
   FC:  JAL       ~Func:guTranslateF
  100:  COPY      A3, A1
  104:  ADDIU     A0, SP, 10
  108:  COPY      A1, S0
  10C:  JAL       ~Func:guMtxCatF
  110:  COPY      A2, A1
  114:  LHU       V0, 0 (S1)
  118:  ORI       V0, V0, 1400
  11C:  BEQ       R0, R0, .o19C
  120:  SH        V0, 0 (S1)
        .o124
  124:  MTC1      R0, F20
  128:  MFC1      A2, F22
  12C:  MFC1      A1, F20
  130:  MFC1      A3, F20
  134:  JAL       ~Func:guTranslateF
  138:  ADDIU     A0, SP, 10
  13C:  ADDIU     A0, SP, 10
  140:  ADDIU     S0, S1, 58
  144:  COPY      A1, S0
  148:  JAL       ~Func:guMtxCatF
  14C:  COPY      A2, S0
  150:  MFC1      A1, F28
  154:  MFC1      A2, F26
  158:  MFC1      A3, F24
  15C:  JAL       $Function_Foliage_SetupShearMatrix
  160:  ADDIU     A0, SP, 10
  164:  ADDIU     A0, SP, 10
  168:  COPY      A1, S0
  16C:  JAL       ~Func:guMtxCatF
  170:  COPY      A2, S0
  174:  ADDIU     A0, SP, 10
  178:  NEG.S     F22, F22
  17C:  MFC1      A1, F20
  180:  MFC1      A2, F22
  184:  JAL       ~Func:guTranslateF
  188:  COPY      A3, A1
  18C:  ADDIU     A0, SP, 10
  190:  COPY      A1, S0
  194:  JAL       ~Func:guMtxCatF
  198:  COPY      A2, A1
        .o19C
  19C:  LW        RA, 5C (SP)
  1A0:  LW        S2, 58 (SP)
  1A4:  LW        S1, 54 (SP)
  1A8:  LW        S0, 50 (SP)
  1AC:  LDC1      F28, 80 (SP)
  1B0:  LDC1      F26, 78 (SP)
  1B4:  LDC1      F24, 70 (SP)
  1B8:  LDC1      F22, 68 (SP)
  1BC:  LDC1      F20, 60 (SP)
  1C0:  ADDIU     V0, R0, 2
  1C4:  JR        RA
  1C8:  ADDIU     SP, SP, 88
}

#new:Script $Script_Foliage_SearchBush
{
    0:  UseIntBuffer  *Var[0]
    C:  Get4Int  *Var[1] *Var[2] *Var[3] *Var[4]
   24:  Call  GetPlayerPos  ( *Var[5] *Var[F] *Var[7] )
   3C:  Thread
   44:      Set   *Flag[00]  .False
   54:      If  *Var[1]  !=  00000000
   64:          Loop  00000005
   70:              UseIntBuffer  *Var[1]
   7C:              Get1Int  *Var[2]
   88:              Loop  *Var[2]
   94:                  Get1Int  *Var[3]
   A0:                  Call  $Function_Foliage_TransformModel    ( *Var[3] *Fixed[0.1] 00000001 *Var[F] 00000000 )
   C0:                  If  *Flag[00]  ==  .False
   D0:                      Set   *Flag[00]  .True
   E0:                      Call  PlaySoundAtModel  ( *Var[3] 00000153 00000000 )
   F8:                  EndIf
  100:              EndLoop
  108:              Wait  1`
  114:              UseIntBuffer  *Var[1]
  120:              Get1Int  *Var[2]
  12C:              Loop  *Var[2]
  138:                  Get1Int  *Var[3]
  144:                  Call  $Function_Foliage_TransformModel    ( *Var[3] *Fixed[0.1] FFFFFFFF *Var[F] 00000000 )
  164:              EndLoop
  16C:              Wait  1`
  178:          EndLoop
  180:          UseIntBuffer  *Var[1]
  18C:          Get1Int  *Var[2]
  198:          Loop  *Var[2]
  1A4:              Get1Int  *Var[3]
  1B0:              Call  TranslateModel    ( *Var[3] 00000000 00000000 00000000 )
  1CC:          EndLoop
  1D4:          Wait  1`
  1E0:      EndIf
  1E8:  EndThread
  1F0:  Thread
  1F8:      If  *Var[2]  !=  00000000
  208:          UseIntBuffer  *Var[2]
  214:          Get1Int  *Var[3]
  220:          Loop  *Var[3]
  22C:              Get1Int  *Var[4]
  238:              Get3Int  *Var[5] *Var[6] *Var[7]
  24C:              Get3Int  *Var[8] *Var[9] *Var[A]
  260:              If  *Var[A]  ==  00000000
  270:                  Call  DropItemEntity    ( *Var[4] *Var[5] *Var[6] *Var[7] *Var[8] *Var[9] )
  294:              Else
  29C:                  Call  GetValueByRef ( *Var[A] *Var[B] )
  2B0:                  If  *Var[B]  ==  00000000
  2C0:                      Call  SetValueByRef     ( *Var[A] 00000001 )
  2D4:                      Call  DropItemEntity    ( *Var[4] *Var[5] *Var[6] *Var[7] *Var[8] *Var[9] )
  2F8:                  EndIf
  300:              EndIf
  308:          EndLoop
  310:      EndIf
  318:  EndThread
  320:  Wait  15`
  32C:  If  *Var[4]  !=  00000000
  33C:      ExecWait  *Var[4]
  348:  EndIf
  350:  Return
  358:  End
}

%=======
% Pipes
%=======

#new:Script $Script_EnterHorizontalPipe
{
	Call  DisablePlayerInput    ( .True )
	Call  DisablePlayerPhysics  ( .True )
	Call  HidePlayerShadow      ( .True )
	Call  ModifyColliderFlags   ( 00000000 *Var[B] 7FFFFE00 )
	Call  GetEntryID    ( *Var[0] )
	Call  $Function_Pipe_GetEntryCoords ( )
	Set   *Var[5]  *Var[1]
	Set   *Var[6]  *Var[2]
	Set   *Var[7]  *Var[3]
	Add   *Var[2]  2`
	Call  SetPlayerPos  ( *Var[1] *Var[2] *Var[3] )
	Call  InterpPlayerYaw       ( *Var[4] 00000000 )
	If  *Var[4]  ==  90`
		Add   *Var[5]  40`
	Else
		Sub   *Var[5]  40`
	EndIf
	Call  UseSettingsFrom   ( .Cam:Default *Var[5] *Var[6] *Var[7] )
	Call  SetPanTarget      ( .Cam:Default *Var[5] *Var[6] *Var[7] )
	Call  SetCamSpeed       ( .Cam:Default *Fixed[90.0] )
	Call  PanToTarget       ( .Cam:Default 00000000 00000001 )
	Call  GetCurrentPartnerID   ( *Var[0] )
	If  *Var[0]  !=  .Partner:None % 0
		Call  DisablePartnerAI  ( 00000000 )
		Call  EnableNpcShadow   ( .Npc:Partner .False )
		Call  SetNpcPos ( .Npc:Partner 00000000 -1000` 00000000 )
		Call  InterpNpcYaw      ( .Npc:Partner *Var[0] 00000000 )
	EndIf
	Wait  1`
	Call  PlaySound ( 00000163 )
	Thread
		Wait  25`
		Call  HidePlayerShadow  ( .False )
	EndThread
	Call  802D286C  ( 00000900 )
	Call  802D2520  ( 00010002 00000005 00000003 00000001 00000001 00000000 )
	Loop  40`
		Call  $Function_Pipe_GetPointInFrontOfPlayer ( *Fixed[1.0] )
		Call  SetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
		Wait  1`
	EndLoop
	Call  GetCurrentPartnerID   ( *Var[0] )
	If  *Var[0]  !=  .Partner:None % 0
		Thread
			Call  GetPlayerPos      ( *Var[0] *Var[1] *Var[2] )
			Sub   *Var[2]  00000003
			Call  SetNpcPos ( .Npc:Partner *Var[0] *Var[1] *Var[2] )
			Call  EnableNpcShadow   ( .Npc:Partner .True )
			Call  EnablePartnerAI ( )
		EndThread
	EndIf
	Wait  5`
	Call  802D2520  ( 00010002 00000000 00000000 00000000 00000000 00000000 )
	Call  ModifyColliderFlags   ( 00000001 *Var[B] 7FFFFE00 )
	Call  DisablePlayerInput    ( .False )
	Call  DisablePlayerPhysics  ( .False )
	Call  PanToTarget   ( .Cam:Default 00000000 00000000 )
	Exec  *Var[A]
	Return
	End
}

#new:Script $Script_EnterVerticalPipe
{
	Call  DisablePlayerInput    ( .True )
	Call  DisablePlayerPhysics  ( .True )
	Call  DisablePartnerAI      ( 00000000 )
	Call  HidePlayerShadow      ( .True )
	Call  SetPlayerAnimation    ( .PlayerAnim:StandStill )
	Call  GetCurrentPartnerID   ( *Var0 )
	If  *Var0  !=  .Partner:None % 0
		Call  EnableNpcShadow   ( .Npc:Partner .False )
		Call  SetNpcPos ( .Npc:Partner 00000000 -1000` 00000000 )
	EndIf
	Call  GetEntryID    ( *Var0 )
	Call  $Function_Pipe_GetEntryCoords
	Sub   *Var2  40`
	Call  SetPlayerPos  ( *Var1 *Var2 *Var3 )
	Call  InterpPlayerYaw   ( *Var4 00000000 )
	Call  PlaySound     ( 00000163 )
	Call  802D286C      ( 00000100 )
	Call  802D2520      ( 00010000 00000005 00000002 00000001 00000001 00000000 )
	Call  GetPlayerPos  ( *Var0 *Var1 *Var2 )
	Loop  40`
		Add   *Var1  00000001
		Call  SetPlayerPos  ( *Var0 *Var1 *Var2 )
		Wait  1`
	EndLoop
	Wait  3`
	Call  GetCurrentPartnerID   ( *Var0 )
	If  *Var0  !=  .Partner:None % 0
		Thread
			Call  DisablePartnerAI  ( 00000000 )
			Call  GetPlayerPos      ( *Var0 *Var1 *Var2 )
			Sub   *Var2  00000003
			Call  SetNpcPos ( .Npc:Partner *Var0 *Var1 *Var2 )
			Call  SetNpcFlagBits    ( .Npc:Partner 00000002 .False )
			Call  EnablePartnerAI
			Call  EnableNpcShadow   ( .Npc:Partner .True )
		EndThread
	EndIf
	Wait  2`
	Call  802D2520  ( 00010000 00000000 00000000 00000000 00000000 00000000 )
	Wait  1`
	Call  SetPlayerAnimation    ( 00010002 )
	Call  DisablePlayerPhysics  ( .False )
	Call  DisablePlayerInput    ( .False )
	Call  HidePlayerShadow      ( .False )
	Label  0
	Call  $Function_Pipe_GetCurrentFloor
	Wait  1`
	If  *Var0  !=  FFFFFFFF % FFFFFFFF
		Goto  0
	EndIf
	Exec  *VarA
	Return
	End
}

/%
	ARGS:
	*VarA  entryID
	*VarB  colliderID
	*VarC  $Script_GotoMap
%/
#new:Script $Script_ExitVerticalPipe
{
	Call  $Function_Pipe_CheckDownInput
	If  *Var0  ==  00000000
		Return
	EndIf
	Call  GetCurrentPartner ( *Var0 )
	If  *Var0  !=  .Partner:None
		Call  GetCurrentPartnerID   ( *Var1 )
		If  *Var1  !=  .Partner:Watt % 6
			Return
		Else
			Call  802D2B6C
			Call  DisablePlayerInput    ( .True )
		EndIf
	Else
		Call  DisablePlayerInput    ( .True )
	EndIf
	SetGroup  0000001B
	Call  $Function_Pipe_SetAnimFlag
	Call  DisablePlayerPhysics  ( .True )
	Call  HidePlayerShadow  ( .True )
	Set   *Var0  *VarA
	Call  $Function_Pipe_GetEntryCoords
	Call  PlayerMoveTo      ( *Var1 *Var3 00000003 )
	Set   *Var0  *VarA
	Call  $Function_Pipe_GetEntryCoords
	Call  SetPlayerPos      ( *Var1 *Var2 *Var3 )
	Call  SetPlayerFlagBits ( 00200000 .True )
	Call  $Function_Pipe_GetCameraYaw
	Call  InterpPlayerYaw   ( *Var0 00000000 )
	Wait  2`
	Call  SetPlayerFlagBits ( 00200000 .False )
	Call  PlaySound ( 00000163 )
	Call  GetPlayerPos      ( *Var0 *Var1 *Var2 )
	Thread
		Wait  4`
		Loop  40`
			Sub   *Var1  00000001
			Call  SetPlayerPos  ( *Var0 *Var1 *Var2 )
			Wait  1`
		EndLoop
	EndThread
	Call  802D286C  ( 00000800 )
	Call  802D2520  ( 00010002 00000005 00000002 00000001 00000001 00000000 )
	Wait  25`
	ExecWait  *VarC
	Return
	End
}

/%
	ARGS:
	*Var[A]  entryID
	*Var[B]  colliderID
	*Var[C]  $Script_GotoMap
%/
#new:Script $Script_ExitHorizontalPipe
{
	Call  802D249C  ( *Var[0] )
	If  *Var[0]  ==  00000000
		Return
	EndIf
	Call  GetPlayerActionState  ( *Var[0] )
	If  *Var[0]  ==  .ActionState:Spin % 1A
		Return
	EndIf
	Call  GetCurrentPartner ( *Var[0] )
	If  *Var[0]  !=  .ActionState:Idle % 0
		Call  GetCurrentPartnerID   ( *Var[1] )
		If  *Var[1]  !=  .Partner:Watt % 6
			Return
		Else
			Call  802D2B6C ( )
			Call  DisablePlayerInput    ( .True )
		EndIf
	Else
		Call  DisablePlayerInput    ( .True )
	EndIf
	SetGroup  0000001B
	Call  $Function_Pipe_SetAnimFlag ( )
	Call  DisablePlayerPhysics  ( .True )
	Call  ModifyColliderFlags   ( 00000000 *Var[B] 7FFFFE00 )
	Set   *Var[0]  *Var[A]
	Call  $Function_Pipe_GetEntryCoords ( )
	Set   *Var[5]  *Var[1]
	Set   *Var[6]  *Var[2]
	Add   *Var[6]  2`
	Set   *Var[7]  *Var[3]
	Set   *Var[8]  *Var[4]
	Add   *Var[8]  180`
	If  *Var[4]  >=  360`
		Sub   *Var[4]  360`
	EndIf
	Call  InterpPlayerYaw       ( *Var[8] 00000001 )
	Wait  1`
	Call  PlaySound     ( 00000163 )
	Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
	Call  SetPlayerPos  ( *Var[0] *Var[6] *Var[7] )
	Call  SetPlayerAnimation    ( .PlayerAnim:StandStill )
	Call  802D286C      ( 00000800 )
	Call  802D2520      ( 00010000 00000005 00000003 00000001 00000001 00000000 )
	Thread
		Wait  8`
		Call  HidePlayerShadow  ( .True )
	EndThread
	Thread
		Wait  3`
		Loop  40`
			Call  $Function_Pipe_GetPointInFrontOfPlayer ( *Fixed[1.0] )
			Call  SetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
			Wait  1`
		EndLoop
	EndThread
	Wait  25`
	ExecWait  *Var[C]
	Return
	End
}

% Pipe functions

#new:Function $Function_Pipe_SetAnimFlag
{
	LAW       V0, 800F7B30
	LW        V1, 4 (V0)
	LUI       A0, 10
	OR        V1, V1, A0
	SW        V1, 4 (V0)
	JR        RA
	ADDIU     V0, R0, 2
}

#new:Function $Function_Pipe_GetCurrentFloor
{
	LAH       V0, 8015A552
	SW        V0, 84 (A0)
	JR        RA
	ADDIU     V0, R0, 2
}

#new:Function $Function_Pipe_CheckDownInput
{
	LAH       V1, 8015A552
	ADDIU     SP, SP, FFE8
	SW        S0, 10 (SP)
	COPY      S0, A0
	SW        RA, 14 (SP)
	LW        V0, B0 (S0)
	BEQ       V1, V0, .o2C
	ADDIU     V0, R0, 2
	BEQ       R0, R0, .oAC
	SW        R0, 84 (S0)
	.o2C
	LAW       V1, 8007419C
	LB        V0, 40 (V1)
	LB        A3, 44 (V1)
	BLTZL     V0, .o44
	SUBU      V0, R0, V0
	.o44
	BNE       V0, R0, .o54
	NOP
	BEQL      A3, R0, .oAC
	CLEAR     V0
	.o54
	MTC1      V0, F4
	NOP
	CVT.S.W   F4, F4
	MFC1      A2, F4
	MTC1      A3, F4
	NOP
	CVT.S.W   F4, F4
	MTC1      R0, F12
	MFC1      A3, F4
	JAL       ~Func:atan2
	MOV.S     F14, F12
	LIF       F2, 60.0
	NOP
	C.LT.S    F0, F2
	NOP
	BC1F      .oA8
	ADDIU     V0, R0, 1
	SW        V0, 84 (S0)
	BEQ       R0, R0, .oAC
	ADDIU     V0, R0, 2
	.oA8
	CLEAR     V0
	.oAC
	LW        RA, 14 (SP)
	LW        S0, 10 (SP)
	JR        RA
	ADDIU     SP, SP, 18
}

#new:Function $Function_Pipe_GetEntryCoords
{
	ADDIU     SP, SP, FFE0
	SW        S1, 14 (SP)
	COPY      S1, A0
	SW        RA, 1C (SP)
	SW        S2, 18 (SP)
	JAL       ~Func:get_current_map_header
	SW        S0, 10 (SP)
	COPY      A0, S1
	LIO       A1, *Var0
	JAL       ~Func:get_variable
	COPY      S2, V0
	COPY      A0, S1
	LUI       A1, FE36
	LW        V1, 14 (S2)
	SLL       S0, V0, 4
	ADDU      V1, S0, V1
	LWC1      F0, 0 (V1)
	TRUNC.W.S F2, F0
	MFC1      A2, F2
	JAL       ~Func:set_variable
	ORI       A1, A1, 3C81 % Var1
	COPY      A0, S1
	LW        V0, 14 (S2)
	LUI       A1, FE36
	ADDU      V0, S0, V0
	LWC1      F0, 4 (V0)
	TRUNC.W.S F2, F0
	MFC1      A2, F2
	JAL       ~Func:set_variable
	ORI       A1, A1, 3C82 % Var2
	COPY      A0, S1
	LW        V0, 14 (S2)
	LUI       A1, FE36
	ADDU      V0, S0, V0
	LWC1      F0, 8 (V0)
	TRUNC.W.S F2, F0
	MFC1      A2, F2
	JAL       ~Func:set_variable
	ORI       A1, A1, 3C83 % Var3
	COPY      A0, S1
	LW        V0, 14 (S2)
	LUI       A1, FE36
	ADDU      S0, S0, V0
	LWC1      F0, C (S0)
	TRUNC.W.S F2, F0
	MFC1      A2, F2
	JAL       ~Func:set_variable
	ORI       A1, A1, 3C84 % Var4
	LW        RA, 1C (SP)
	LW        S2, 18 (SP)
	LW        S1, 14 (SP)
	LW        S0, 10 (SP)
	ADDIU     V0, R0, 2
	JR        RA
	ADDIU     SP, SP, 20
}

#new:Function $Function_Pipe_GetCameraYaw
{
	LAW       V1, 80077410
	LIF       F12, 180.0
	ADDIU     SP, SP, FFE8
	SW        RA, 14 (SP)
	SW        S0, 10 (SP)
	SLL       V0, V1, 2
	ADDU      V0, V0, V1
	SLL       V0, V0, 2
	SUBU      V0, V0, V1
	SLL       V1, V0, 3
	ADDU      V0, V0, V1
	SLL       V0, V0, 3
	LTF       F0, V0 (800B1DEC)
	ADD.S     F12, F0, F12
	JAL       ~Func:clamp_angle
	COPY      S0, A0
	TRUNC.W.S F2, F0
	SWC1      F2, 84 (S0)
	LW        RA, 14 (SP)
	LW        S0, 10 (SP)
	ADDIU     V0, R0, 2
	JR        RA
	ADDIU     SP, SP, 18
}

#new:Function $Function_Pipe_GetPointInFrontOfPlayer
{
	ADDIU     SP, SP, FFD8
	SW        S0, 18 (SP)
	COPY      S0, A0
	SW        RA, 1C (SP)
	SDC1      F20, 20 (SP)
	LW        V0, C (S0)
	JAL       ~Func:get_float_variable
	LW        A1, 0 (V0)
	ADDIU     A0, SP, 10
	LIA       V0, 8010EFC8
	MFC1      A2, F0
	LWC1      F0, 28 (V0) % player X
	LWC1      F2, 30 (V0) % player Z
	SWC1      F0, 10 (SP) % arg0 for add_vec2D_polar
	SWC1      F2, 14 (SP) % arg1 for add_vec2D_polar
	LW        A3, 80 (V0)
	LWC1      F20, 2C (V0)
	JAL       ~Func:add_vec2D_polar
	ADDIU     A1, SP, 14
	COPY      A0, S0
	LUI       A1, FE36
	LW        A2, 10 (SP)
	JAL       ~Func:set_float_variable
	ORI       A1, A1, 3C80 % Var0
	COPY      A0, S0
	LUI       A1, FE36
	MFC1      A2, F20
	JAL       ~Func:set_float_variable
	ORI       A1, A1, 3C81 % Var1
	COPY      A0, S0
	LUI       A1, FE36
	LW        A2, 14 (SP)
	JAL       ~Func:set_float_variable
	ORI       A1, A1, 3C82 % Var2
	LW        RA, 1C (SP)
	LW        S0, 18 (SP)
	LDC1      F20, 20 (SP)
	ADDIU     V0, R0, 2
	JR        RA
	ADDIU     SP, SP, 28
}

%

#new:Function $Function_GetTattle
{
LIO       V0, $String_Tattle
JR        RA
RESERVED
}

#string $String_Tattle
{
[Style Tattle][EnableCDownNext]
See all those tree branches?[BR]
It's almost like we're inside we're[BR]
inside some sort of giant tree.[BR]
[Wait][Next]
It sure isn't any tree I've seen,[BR]
though. What a weird place.
[Wait][End]
}
